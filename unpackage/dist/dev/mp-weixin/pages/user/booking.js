(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["pages/user/booking"],{

/***/ 232:
/*!*********************************************************************************************************************!*\
  !*** C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/main.js?{"page":"pages%2Fuser%2Fbooking"} ***!
  \*********************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(wx, createPage) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
__webpack_require__(/*! uni-pages */ 38);
__webpack_require__(/*! @dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js */ 26);
var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 25));
var _booking = _interopRequireDefault(__webpack_require__(/*! ./pages/user/booking.vue */ 233));
// @ts-ignore
wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;
createPage(_booking.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/wx.js */ 1)["default"], __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 2)["createPage"]))

/***/ }),

/***/ 233:
/*!**************************************************************************************************!*\
  !*** C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/pages/user/booking.vue ***!
  \**************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./booking.vue?vue&type=template&id=6e50388e& */ 234);
/* harmony import */ var _booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./booking.vue?vue&type=script&lang=js& */ 236);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _booking_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./booking.vue?vue&type=style&index=0&lang=scss& */ 238);
/* harmony import */ var _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */ 44);

var renderjs





/* normalize component */

var component = Object(_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__["render"],
  _booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  null,
  null,
  false,
  _booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__["components"],
  renderjs
)

component.options.__file = "pages/user/booking.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 234:
/*!*********************************************************************************************************************************!*\
  !*** C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/pages/user/booking.vue?vue&type=template&id=6e50388e& ***!
  \*********************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--17-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./booking.vue?vue&type=template&id=6e50388e& */ 235);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__["recyclableRender"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "components", function() { return _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_template_id_6e50388e___WEBPACK_IMPORTED_MODULE_0__["components"]; });



/***/ }),

/***/ 235:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--17-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/pages/user/booking.vue?vue&type=template&id=6e50388e& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return recyclableRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
var components
try {
  components = {
    loadMore: function () {
      return __webpack_require__.e(/*! import() | components/load-more/load-more */ "components/load-more/load-more").then(__webpack_require__.bind(null, /*! @/components/load-more/load-more.vue */ 55))
    },
    emptyTip: function () {
      return __webpack_require__.e(/*! import() | components/empty-tip/empty-tip */ "components/empty-tip/empty-tip").then(__webpack_require__.bind(null, /*! @/components/empty-tip/empty-tip.vue */ 48))
    },
  }
} catch (e) {
  if (
    e.message.indexOf("Cannot find module") !== -1 &&
    e.message.indexOf(".vue") !== -1
  ) {
    console.error(e.message)
    console.error("1. 排查组件名称拼写是否正确")
    console.error(
      "2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"
    )
    console.error(
      "3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件"
    )
  } else {
    throw e
  }
}
var render = function () {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
  var l0 = _vm.__map(_vm.tabs, function (tab, index) {
    var $orig = _vm.__get_orig(tab)
    var m0 = _vm.getTabCount(tab.value)
    var m1 = m0 > 0 ? _vm.getTabCount(tab.value) : null
    return {
      $orig: $orig,
      m0: m0,
      m1: m1,
    }
  })
  var l1 = _vm.__map(_vm.filteredBookingList, function (item, index) {
    var $orig = _vm.__get_orig(item)
    var m2 = _vm.shouldShowCountdown(item)
    var m3 = m2 ? _vm.getStatusText(item) : null
    var m4 = m2 ? _vm.formatCountdown(_vm.getPaymentCountdown(item)) : null
    var m5 = !m2 ? _vm.getStatusText(item) : null
    var m6 = _vm.showAutoCancelTag(item)
    var m7 = _vm.formatCourseTime(item)
    var m8 = _vm.formatDateRange(item)
    var m9 = _vm.formatBookingTime(item.createTime || item.create_time)
    var m10 = _vm.showActions(item)
    var m11 = m10 ? _vm.shouldShowPayButton(item) : null
    var m12 = m10 ? _vm.shouldShowContactButton(item) : null
    return {
      $orig: $orig,
      m2: m2,
      m3: m3,
      m4: m4,
      m5: m5,
      m6: m6,
      m7: m7,
      m8: m8,
      m9: m9,
      m10: m10,
      m11: m11,
      m12: m12,
    }
  })
  var g0 = _vm.filteredBookingList.length
  var m13 = g0 === 0 ? _vm.getEmptyTipText() : null
  if (!_vm._isMounted) {
    _vm.e0 = function ($event, item) {
      var _temp = arguments[arguments.length - 1].currentTarget.dataset,
        _temp2 = _temp.eventParams || _temp["event-params"],
        item = _temp2.item
      var _temp, _temp2
      $event.stopPropagation()
      return (function ($event) {
        return _vm.cancelBooking(item, $event)
      })($event)
    }
    _vm.e1 = function ($event, item) {
      var _temp3 = arguments[arguments.length - 1].currentTarget.dataset,
        _temp4 = _temp3.eventParams || _temp3["event-params"],
        item = _temp4.item
      var _temp3, _temp4
      $event.stopPropagation()
      return (function ($event) {
        return _vm.goToPay(item, $event)
      })($event)
    }
    _vm.e2 = function ($event, item) {
      var _temp5 = arguments[arguments.length - 1].currentTarget.dataset,
        _temp6 = _temp5.eventParams || _temp5["event-params"],
        item = _temp6.item
      var _temp5, _temp6
      $event.stopPropagation()
      return (function ($event) {
        return _vm.contactTeacher(item, $event)
      })($event)
    }
    _vm.e3 = function ($event, item) {
      var _temp7 = arguments[arguments.length - 1].currentTarget.dataset,
        _temp8 = _temp7.eventParams || _temp7["event-params"],
        item = _temp8.item
      var _temp7, _temp8
      $event.stopPropagation()
      return (function ($event) {
        return _vm.handleRefund(item, $event)
      })($event)
    }
  }
  _vm.$mp.data = Object.assign(
    {},
    {
      $root: {
        l0: l0,
        l1: l1,
        g0: g0,
        m13: m13,
      },
    }
  )
}
var recyclableRender = false
var staticRenderFns = []
render._withStripped = true



/***/ }),

/***/ 236:
/*!***************************************************************************************************************************!*\
  !*** C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/pages/user/booking.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./booking.vue?vue&type=script&lang=js& */ 237);
/* harmony import */ var _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 237:
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/pages/user/booking.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(uni, uniCloud) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ 27));
var _defineProperty2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/defineProperty */ 11));
var _toConsumableArray2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/toConsumableArray */ 18));
var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ 30));
var _typeof2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/typeof */ 13));
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }
function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }
function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }
function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
var _default = {
  data: function data() {
    return {
      // 状态筛选标签
      tabs: [{
        label: '全部',
        value: 'all'
      }, {
        label: '已预约',
        value: 'booked'
      }, {
        label: '已完成',
        value: 'finished'
      }, {
        label: '已取消',
        value: 'cancelled'
      }, {
        label: '已退费',
        value: 'refunded'
      }],
      currentStatus: 'all',
      // 列表数据
      bookingList: [],
      page: 1,
      limit: 10,
      total: 0,
      loadMoreStatus: 'more',
      // more-加载更多 loading-加载中 noMore-没有更多了

      // 当前操作的预约
      currentBooking: null,
      // 缓存的各状态预约数量
      statusCounts: {
        all: 0,
        booked: 0,
        finished: 0,
        cancelled: 0,
        refunded: 0
      },
      // 是否已加载本地取消记录
      localCancelledLoaded: false,
      // 支付倒计时数据
      countdownTimers: {},
      // 存储每个预约的倒计时定时器
      countdownValues: {} // 存储每个预约的倒计时值
    };
  },

  computed: {
    // 根据当前选择的状态过滤预约列表
    filteredBookingList: function filteredBookingList() {
      var _this = this;
      // 首先确保bookingList是数组且过滤掉无效项
      var validBookings = Array.isArray(this.bookingList) ? this.bookingList.filter(function (item) {
        return item && (0, _typeof2.default)(item) === 'object' && item._id;
      }) : [];
      if (this.currentStatus === 'all') {
        return validBookings;
      }
      if (this.currentStatus === 'booked') {
        // 已预约包含所有非取消和非完成的状态
        return validBookings.filter(function (booking) {
          return booking.status === 'pending' || booking.status === 'confirmed_unpaid' || booking.status === 'confirmed';
        });
      }
      if (this.currentStatus === 'cancelled') {
        // 已取消状态的过滤条件
        return validBookings.filter(function (booking) {
          return booking.status === 'cancelled' || booking.paymentStatus === 'cancelled' || booking.status === 'cancel';
        });
      }
      if (this.currentStatus === 'refunded') {
        // 已退费状态的过滤条件
        return validBookings.filter(function (booking) {
          return booking.paymentStatus === 'refunded';
        });
      }

      // 其他状态直接按状态筛选
      return validBookings.filter(function (booking) {
        return booking.status === _this.currentStatus;
      });
    }
  },
  onLoad: function onLoad(options) {
    var _this2 = this;
    console.log('booking页面加载，参数:', options);

    // 先获取自动取消的预约ID列表，用于后续渲染
    var autoCancelIds = this.getAutoCancelledBookingIds();
    console.log('加载时找到自动取消预约IDs:', autoCancelIds);

    // 监听支付成功事件
    uni.$on('payment:success', this.handlePaymentSuccess);

    // 处理特殊状态
    if (options.status) {
      // 处理booked状态（表示已预约的课程，包括待确认和已确认）
      if (options.status === 'usable' || options.status === 'booked') {
        this.currentStatus = 'booked';
      }
      // 处理expired状态（表示已过期，即已完成）
      else if (options.status === 'expired' || options.status === 'finished') {
        this.currentStatus = 'finished';
      }
      // 处理canceled/cancelled状态（表示已取消）
      else if (options.status === 'canceled' || options.status === 'cancelled') {
        this.currentStatus = 'cancelled';
      }
      // 其他状态直接使用all
      else {
        this.currentStatus = 'all';
      }
    }
    console.log('设置当前状态为:', this.currentStatus);

    // 无论当前标签是什么，先加载本地已取消记录的数量
    this.loadLocalCancelledCount();

    // 加载预约记录
    this.loadBookingList().then(function () {
      // 加载完成后初始化倒计时
      console.log('预约记录加载完成，初始化倒计时');
      setTimeout(function () {
        _this2.initAllCountdowns();

        // 重新检查并标记自动取消的预约
        if (typeof _this2.ensureAutoCancelTagsDisplayed === 'function') {
          _this2.ensureAutoCancelTagsDisplayed();
        } else {
          console.log('ensureAutoCancelTagsDisplayed方法未定义，跳过执行');
        }
      }, 500);
    });
  },
  // 确保自动取消标签正确显示
  ensureAutoCancelTagsDisplayed: function ensureAutoCancelTagsDisplayed() {
    var autoCancelIds = this.getAutoCancelledBookingIds();
    if (autoCancelIds.length > 0) {
      console.log('重新检查自动取消标记，找到:', autoCancelIds);

      // 更新bookingList中对应ID的预约
      var updatedCount = 0;
      this.bookingList.forEach(function (booking) {
        if (booking && booking._id && autoCancelIds.includes(booking._id)) {
          if (!booking.autoCancel || !booking.cancelReason) {
            console.log("\u5F3A\u5236\u66F4\u65B0\u9884\u7EA6 ".concat(booking.bookingId, " \u7684\u81EA\u52A8\u53D6\u6D88\u6807\u8BB0"));
            booking.autoCancel = true;
            booking.cancelReason = '超时未支付，系统自动取消';
            updatedCount++;
          }
        }
      });
      if (updatedCount > 0) {
        console.log("\u66F4\u65B0\u4E86 ".concat(updatedCount, " \u4E2A\u9884\u7EA6\u7684\u81EA\u52A8\u53D6\u6D88\u6807\u8BB0\u72B6\u6001"));
        this.$forceUpdate();
      }
    }
  },
  onShow: function onShow() {
    var _this3 = this;
    // 检查是否有预约状态变更
    var hasBookingChanged = uni.getStorageSync('booking_changed') === 'true';
    if (hasBookingChanged) {
      console.log('检测到预约状态变更，刷新列表');
      this.resetList();
      this.loadBookingList().then(function () {
        // 加载完成后初始化倒计时
        setTimeout(function () {
          _this3.initAllCountdowns();
          if (typeof _this3.ensureAutoCancelTagsDisplayed === 'function') {
            _this3.ensureAutoCancelTagsDisplayed();
          } else {
            console.log('ensureAutoCancelTagsDisplayed方法未定义，跳过执行');
          }
        }, 500);
      });
      // 重置标记
      uni.setStorageSync('booking_changed', 'false');
    } else {
      // 即使没有变更，也重新初始化倒计时
      console.log('页面显示，重新初始化倒计时');
      this.initAllCountdowns();
      if (typeof this.ensureAutoCancelTagsDisplayed === 'function') {
        this.ensureAutoCancelTagsDisplayed();
      } else {
        console.log('ensureAutoCancelTagsDisplayed方法未定义，跳过执行');
      }
    }
  },
  onHide: function onHide() {
    // 页面隐藏时清除所有定时器
    this.clearAllCountdowns();
  },
  onUnload: function onUnload() {
    // 页面卸载时清除所有定时器
    this.clearAllCountdowns();

    // 清除事件监听
    uni.$off('payment:success', this.handlePaymentSuccess);
  },
  onPullDownRefresh: function onPullDownRefresh() {
    this.resetList();
    this.loadBookingList().then(function () {
      uni.stopPullDownRefresh();
    });
  },
  onReachBottom: function onReachBottom() {
    if (this.loadMoreStatus === 'more') {
      this.loadMore();
    }
  },
  methods: {
    // 切换筛选标签
    changeTab: function changeTab(status) {
      if (this.currentStatus === status) return;
      this.currentStatus = status;
      this.resetList();

      // 如果切换到已取消标签页，确保本地存储的已取消记录被加载
      if (status === 'cancelled') {
        console.log('切换到已取消标签页，确保加载本地记录');
        // 先尝试显示本地已取消记录
        try {
          var userInfoStr = uni.getStorageSync('userInfo');
          if (userInfoStr) {
            try {
              // 检查是否已经是对象
              var userData = typeof userInfoStr === 'string' ? JSON.parse(userInfoStr) : userInfoStr;
              var userId = userData.userId || userData._id || userData.uid || userData.userInfo && userData.userInfo._id || userData.userInfo && userData.userInfo.uid || '';
              if (userId) {
                // 从本地存储获取已取消预约
                var localCancelledBookings = this.getLocalCancelledBookings(userId);
                if (localCancelledBookings && localCancelledBookings.length > 0) {
                  console.log("\u627E\u5230".concat(localCancelledBookings.length, "\u6761\u672C\u5730\u5DF2\u53D6\u6D88\u8BB0\u5F55\uFF0C\u7ACB\u5373\u663E\u793A"));
                  this.bookingList = localCancelledBookings;
                  this.total = localCancelledBookings.length;
                  this.$forceUpdate();
                }
              }
            } catch (e) {
              console.error('尝试直接加载本地已取消记录失败:', e);
            }
          }
        } catch (e) {
          console.error('尝试直接加载本地已取消记录失败:', e);
        }
      }
      this.loadBookingList();
    },
    // 重置列表数据
    resetList: function resetList() {
      this.page = 1;
      this.bookingList = [];
    },
    // 加载更多
    loadMore: function loadMore() {
      this.page++;
      this.loadBookingList();
    },
    // 加载预约记录列表
    loadBookingList: function loadBookingList() {
      var _this4 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {
        var userInfoStr, userData, userId, localCancelledBookings, status, useClientFiltering, statusForLog, res, allBookings, totalCount, cancelledInList, refundedCount, pendingCount, cancelledBookings, _localCancelledBookings, existingIds, newLocalCancelled, _userId, _localCancelledBookings2;
        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _this4.loadMoreStatus = 'loading';
                _context.prev = 1;
                userInfoStr = uni.getStorageSync('userInfo');
                if (userInfoStr) {
                  _context.next = 8;
                  break;
                }
                console.log('用户未登录，无法获取预约记录');
                uni.showToast({
                  title: '请先登录',
                  icon: 'none'
                });
                setTimeout(function () {
                  uni.redirectTo({
                    url: '/pages/user/user'
                  });
                }, 1500);
                return _context.abrupt("return", Promise.resolve());
              case 8:
                userData = null;
                _context.prev = 9;
                // 检查是否已经是对象
                userData = typeof userInfoStr === 'string' ? JSON.parse(userInfoStr) : userInfoStr;
                console.log('解析到的用户信息:', userData);
                _context.next = 19;
                break;
              case 14:
                _context.prev = 14;
                _context.t0 = _context["catch"](9);
                console.error('解析用户信息失败:', _context.t0);
                uni.showToast({
                  title: '用户数据异常',
                  icon: 'none'
                });
                return _context.abrupt("return", Promise.resolve());
              case 19:
                userId = userData.userId || userData._id || userData.uid || userData.userInfo && userData.userInfo._id || userData.userInfo && userData.userInfo.uid || '';
                if (userId) {
                  _context.next = 24;
                  break;
                }
                console.error('未找到有效的用户ID');
                uni.showToast({
                  title: '用户ID不存在',
                  icon: 'none'
                });
                return _context.abrupt("return", Promise.resolve());
              case 24:
                // 如果是已取消标签，先检查本地存储中是否有取消记录
                if (_this4.currentStatus === 'cancelled') {
                  console.log('当前为已取消标签，优先检查本地存储');
                  localCancelledBookings = _this4.getLocalCancelledBookings(userId).filter(function (item) {
                    return item && item._id;
                  });
                  if (localCancelledBookings.length > 0) {
                    console.log("\u627E\u5230".concat(localCancelledBookings.length, "\u6761\u672C\u5730\u5DF2\u53D6\u6D88\u8BB0\u5F55\uFF0C\u7ACB\u5373\u663E\u793A"));
                    // 不完全替换，而是先加载本地数据
                    _this4.bookingList = localCancelledBookings;
                    _this4.total = localCancelledBookings.length;
                    // 更新计数
                    _this4.statusCounts.cancelled = localCancelledBookings.length;
                    // 强制刷新UI
                    _this4.$forceUpdate();
                    uni.showToast({
                      title: "\u52A0\u8F7D\u4E86".concat(localCancelledBookings.length, "\u6761\u5DF2\u53D6\u6D88\u8BB0\u5F55"),
                      icon: 'none',
                      duration: 1500
                    });
                  }
                }

                // 根据当前选择的状态获取查询参数
                // 注意：为了解决服务器可能存在的问题，始终获取所有预约记录，然后在前端过滤
                status = '';
                useClientFiltering = false; // 只为日志显示
                statusForLog = _this4.currentStatus; // 如果请求特定状态并且不是全部，使用前端过滤
                if (_this4.currentStatus !== 'all') {
                  useClientFiltering = true;
                }
                console.log('查询预约记录，状态:', statusForLog, '用户ID:', userId, '使用前端过滤:', useClientFiltering);

                // 调用云函数获取预约记录
                _context.next = 32;
                return uniCloud.callFunction({
                  name: 'getBookings',
                  data: {
                    userId: userId,
                    status: '',
                    // 获取所有状态的预约
                    limit: _this4.limit * 5,
                    // 增加获取数量以确保足够多的记录用于筛选
                    skip: 0 // 从0开始获取以确保全部记录都获取到
                  }
                });
              case 32:
                res = _context.sent;
                console.log('getBookings原始返回结果:', res.result);
                if (res.result && res.result.success) {
                  // 过滤掉undefined和null值
                  allBookings = (res.result.data || []).filter(function (item) {
                    return item && item._id;
                  });
                  totalCount = res.result.total || 0;
                  console.log("API\u83B7\u53D6\u5230".concat(allBookings.length, "\u6761\u9884\u7EA6\u8BB0\u5F55\uFF0C\u603B\u6570: ").concat(totalCount));

                  // 更新总计数
                  _this4.statusCounts.all = allBookings.length;

                  // 计算各状态数量
                  _this4.statusCounts.booked = allBookings.filter(function (item) {
                    return item && (item.status === 'pending' || item.status === 'confirmed_unpaid' || item.status === 'confirmed');
                  }).length;
                  _this4.statusCounts.finished = allBookings.filter(function (item) {
                    return item && item.status === 'finished';
                  }).length;
                  cancelledInList = allBookings.filter(function (item) {
                    return item && (item.status === 'cancelled' || item.paymentStatus === 'cancelled' || item.status === 'cancel');
                  }).length; // 如果已经从本地加载了取消记录，使用更大的值
                  if (!_this4.localCancelledLoaded || cancelledInList > _this4.statusCounts.cancelled) {
                    _this4.statusCounts.cancelled = cancelledInList;
                  }

                  // 统计已退费的预约数量
                  refundedCount = allBookings.filter(function (item) {
                    return item && item.paymentStatus === 'refunded';
                  }).length;
                  _this4.statusCounts.refunded = refundedCount;

                  // 确保每个预约都有_id字段
                  allBookings = allBookings.filter(function (item) {
                    return item && item._id;
                  });

                  // 更新自动取消标记信息
                  allBookings.forEach(function (booking) {
                    if (booking.status === 'cancelled') {
                      // 检查本地存储中是否为自动取消
                      var isAutoCancel = _this4.isAutoCancelBookingFromStorage(booking._id);
                      if (isAutoCancel) {
                        console.log("\u66F4\u65B0\u9884\u7EA6 ".concat(booking.bookingId || booking._id, " \u7684\u81EA\u52A8\u53D6\u6D88\u6807\u8BB0"));
                        booking.autoCancel = true;
                        booking.cancelReason = '超时未支付，系统自动取消';
                      }
                    }
                  });

                  // 更新列表
                  _this4.bookingList = allBookings;
                  _this4.total = allBookings.length;
                  console.log("\u524D\u7AEF\u7B5B\u9009\u540E\u7684\u9884\u7EA6\u8BB0\u5F55\u6570: ".concat(_this4.bookingList.length));

                  // 更新加载状态
                  _this4.loadMoreStatus = 'noMore'; // 已获取全部数据

                  // 日志显示有多少pending状态的预约
                  pendingCount = allBookings.filter(function (item) {
                    return item && item.status === 'pending';
                  }).length;
                  console.log("\u83B7\u53D6\u5230".concat(pendingCount, "\u6761\u5F85\u652F\u4ED8\u9884\u7EA6\u8BB0\u5F55"));

                  // 在前端根据状态筛选
                  if (useClientFiltering) {
                    if (_this4.currentStatus === 'booked') {
                      allBookings = allBookings.filter(function (item) {
                        return item && (item.status === 'pending' || item.status === 'confirmed_unpaid' || item.status === 'confirmed');
                      });
                    } else if (_this4.currentStatus === 'finished') {
                      allBookings = allBookings.filter(function (item) {
                        return item && item.status === 'finished';
                      });
                    } else if (_this4.currentStatus === 'cancelled') {
                      // 重点：筛选出已取消的预约（包含本地存储的）
                      cancelledBookings = allBookings.filter(function (item) {
                        return item && (item.status === 'cancelled' || item.paymentStatus === 'cancelled' || item.status === 'cancel');
                      }); // 获取本地已取消的预约
                      _localCancelledBookings = _this4.getLocalCancelledBookings(userId).filter(function (item) {
                        return item && item._id;
                      }); // 合并本地和远程的已取消预约，避免重复
                      if (_localCancelledBookings.length > 0) {
                        existingIds = cancelledBookings.map(function (item) {
                          return item._id;
                        });
                        newLocalCancelled = _localCancelledBookings.filter(function (item) {
                          return !existingIds.includes(item._id);
                        });
                        if (newLocalCancelled.length > 0) {
                          console.log("\u6DFB\u52A0".concat(newLocalCancelled.length, "\u6761\u672C\u5730\u5DF2\u53D6\u6D88\u9884\u7EA6\u5230\u5217\u8868"));
                          cancelledBookings = [].concat((0, _toConsumableArray2.default)(cancelledBookings), (0, _toConsumableArray2.default)(newLocalCancelled));
                        }
                      }
                      allBookings = cancelledBookings;

                      // 打印筛选后的已取消记录
                      console.log('前端筛选后的已取消预约记录:', allBookings);
                    } else if (_this4.currentStatus === 'refunded') {
                      // 筛选出已退费的预约
                      allBookings = allBookings.filter(function (item) {
                        return item && item.paymentStatus === 'refunded';
                      });
                      console.log('前端筛选后的已退费预约记录:', allBookings);
                    }
                  }
                } else {
                  console.error('获取预约记录API返回失败:', res.result);
                  // 显示错误提示
                  uni.showToast({
                    title: '获取预约记录失败',
                    icon: 'none'
                  });

                  // 错误情况下，尝试从本地加载已取消预约
                  if (_this4.currentStatus === 'cancelled') {
                    try {
                      _userId = _this4.getUserId();
                      if (_userId) {
                        _localCancelledBookings2 = _this4.getLocalCancelledBookings(_userId);
                        if (_localCancelledBookings2.length > 0) {
                          _this4.bookingList = _localCancelledBookings2;
                          _this4.statusCounts.cancelled = _localCancelledBookings2.length;
                          _this4.total = _localCancelledBookings2.length;
                          _this4.localCancelledLoaded = true;
                          console.log("\u52A0\u8F7D\u4E86".concat(_localCancelledBookings2.length, "\u6761\u672C\u5730\u5DF2\u53D6\u6D88\u8BB0\u5F55"));
                          _this4.$forceUpdate();
                        }
                      }
                    } catch (localErr) {
                      console.error('加载本地已取消记录失败:', localErr);
                    }
                  }
                }
                _context.next = 41;
                break;
              case 37:
                _context.prev = 37;
                _context.t1 = _context["catch"](1);
                console.error('获取预约记录失败:', _context.t1);
                // 显示错误提示
                uni.showToast({
                  title: '获取预约记录失败',
                  icon: 'none'
                });
              case 41:
                // 更新UI显示
                _this4.$forceUpdate();
                return _context.abrupt("return", Promise.resolve());
              case 43:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, null, [[1, 37], [9, 14]]);
      }))();
    },
    // 从本地存储获取已取消的预约记录
    getLocalCancelledBookings: function getLocalCancelledBookings(userId) {
      try {
        // 参数检查
        if (!userId) {
          console.warn('获取本地已取消预约记录: 用户ID为空');
          return [];
        }

        // 获取已取消预约ID列表
        var cancelledIds = uni.getStorageSync('cancelled_booking_ids') || '[]';
        try {
          // 检查是否已经是数组
          cancelledIds = typeof cancelledIds === 'string' ? JSON.parse(cancelledIds) : cancelledIds;
          if (!Array.isArray(cancelledIds)) {
            console.warn('已取消预约ID列表格式不正确，重置为空数组');
            cancelledIds = [];
          }
        } catch (e) {
          console.error('解析已取消预约ID列表失败:', e);
          cancelledIds = [];
        }
        if (!cancelledIds.length) {
          return [];
        }

        // 从本地存储获取每个已取消预约的详细信息
        var cancelledBookings = [];
        var _iterator = _createForOfIteratorHelper(cancelledIds),
          _step;
        try {
          for (_iterator.s(); !(_step = _iterator.n()).done;) {
            var id = _step.value;
            if (!id) continue; // 跳过无效ID

            var key = "cancelled_booking_".concat(id);
            var bookingStr = void 0;
            try {
              bookingStr = uni.getStorageSync(key);
            } catch (e) {
              console.error("\u83B7\u53D6\u9884\u7EA6\u6570\u636E\u5931\u8D25 (ID: ".concat(id, "):"), e);
              continue;
            }
            if (bookingStr) {
              try {
                // 检查是否已经是对象
                var booking = typeof bookingStr === 'string' ? JSON.parse(bookingStr) : bookingStr;

                // 确保必要字段存在
                if (!booking || !booking._id) {
                  console.warn("\u65E0\u6548\u7684\u9884\u7EA6\u6570\u636E (ID: ".concat(id, ")\uFF0C\u8DF3\u8FC7"));
                  continue;
                }

                // 确保状态为cancelled
                booking.status = 'cancelled';

                // 确保有取消时间
                if (!booking.cancelTime) {
                  booking.cancelTime = new Date().toISOString();
                }

                // 检查并设置自动取消标记
                if (booking.cancelReason === '超时未支付，系统自动取消' && !booking.autoCancel) {
                  booking.autoCancel = true;
                  console.log("\u8BBE\u7F6E\u9884\u7EA6 ".concat(id, " \u7684\u81EA\u52A8\u53D6\u6D88\u6807\u8BB0"));
                }

                // 确保有课程标题
                if (!booking.title && booking.courseName) {
                  booking.title = booking.courseName;
                }

                // 确保有课程ID
                if (!booking.courseId && booking.course_id) {
                  booking.courseId = booking.course_id;
                }

                // 确保用户ID匹配
                if (booking.userId === userId) {
                  cancelledBookings.push(booking);
                } else if (String(booking.userId) === String(userId)) {
                  // 类型不同但值相同的情况
                  console.log("\u9884\u7EA6\u7528\u6237ID\u7C7B\u578B\u4E0D\u540C\uFF0C\u4FEE\u6B63\u540E\u5339\u914D (\u9884\u7EA6ID: ".concat(id, ")"));
                  booking.userId = userId; // 统一为传入的userId格式
                  cancelledBookings.push(booking);
                } else {
                  console.log("\u9884\u7EA6\u7528\u6237ID\u4E0D\u5339\u914D (\u9884\u7EA6ID: ".concat(id, ", \u9884\u7EA6\u7528\u6237: ").concat(booking.userId, ", \u5F53\u524D\u7528\u6237: ").concat(userId, ")"));
                }
              } catch (e) {
                console.error('解析已取消预约数据失败:', e);
              }
            }
          }
        } catch (err) {
          _iterator.e(err);
        } finally {
          _iterator.f();
        }
        console.log("\u4E3A\u7528\u6237 ".concat(userId, " \u83B7\u53D6\u5230 ").concat(cancelledBookings.length, " \u6761\u672C\u5730\u5DF2\u53D6\u6D88\u9884\u7EA6\u8BB0\u5F55"));

        // 异步同步本地已取消预约到数据库
        this.syncCancelledBookingsToCloud(cancelledBookings);
        return cancelledBookings;
      } catch (e) {
        console.error('获取本地已取消预约记录失败:', e);
        return [];
      }
    },
    // 将本地已取消的预约同步到云数据库
    syncCancelledBookingsToCloud: function syncCancelledBookingsToCloud(bookings) {
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {
        var syncedIds, newSyncedIds, syncCount, _iterator2, _step2, booking, result;
        return _regenerator.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                if (!(!bookings || !bookings.length)) {
                  _context2.next = 2;
                  break;
                }
                return _context2.abrupt("return");
              case 2:
                console.log("\u5C1D\u8BD5\u540C\u6B65 ".concat(bookings.length, " \u6761\u5DF2\u53D6\u6D88\u9884\u7EA6\u5230\u4E91\u6570\u636E\u5E93"));

                // 获取已同步ID缓存，避免重复同步
                syncedIds = uni.getStorageSync('synced_cancelled_ids') || '[]';
                try {
                  // 检查是否已经是数组
                  syncedIds = typeof syncedIds === 'string' ? JSON.parse(syncedIds) : syncedIds;
                  if (!Array.isArray(syncedIds)) {
                    syncedIds = [];
                  }
                } catch (e) {
                  console.error('解析已同步ID列表失败:', e);
                  syncedIds = [];
                }
                newSyncedIds = (0, _toConsumableArray2.default)(syncedIds);
                syncCount = 0;
                _iterator2 = _createForOfIteratorHelper(bookings);
                _context2.prev = 8;
                _iterator2.s();
              case 10:
                if ((_step2 = _iterator2.n()).done) {
                  _context2.next = 34;
                  break;
                }
                booking = _step2.value;
                _context2.prev = 12;
                if (booking._id) {
                  _context2.next = 15;
                  break;
                }
                return _context2.abrupt("continue", 32);
              case 15:
                if (!syncedIds.includes(booking._id)) {
                  _context2.next = 17;
                  break;
                }
                return _context2.abrupt("continue", 32);
              case 17:
                _context2.prev = 17;
                _context2.next = 20;
                return uniCloud.callFunction({
                  name: 'forceUpdateBooking',
                  data: {
                    bookingId: booking._id,
                    status: 'cancelled',
                    updateCourseCount: true // 确保更新课程报名人数
                  }
                });
              case 20:
                result = _context2.sent;
                if (result.result && result.result.success) {
                  syncCount++;
                  newSyncedIds.push(booking._id);

                  // 不要频繁打印日志，只在首次同步和最后一条时打印
                  if (syncCount === 1 || syncCount === bookings.length) {
                    console.log("\u5DF2\u6210\u529F\u540C\u6B65 ".concat(syncCount, "/").concat(bookings.length, " \u6761\u5DF2\u53D6\u6D88\u9884\u7EA6"));
                  }

                  // 每成功同步5条记录就保存一次同步缓存
                  if (syncCount % 5 === 0) {
                    uni.setStorageSync('synced_cancelled_ids', JSON.stringify(newSyncedIds));
                  }
                }
                _context2.next = 27;
                break;
              case 24:
                _context2.prev = 24;
                _context2.t0 = _context2["catch"](17);
                console.error("\u540C\u6B65\u5DF2\u53D6\u6D88\u9884\u7EA6 ".concat(booking._id, " \u5931\u8D25:"), _context2.t0);
              case 27:
                _context2.next = 32;
                break;
              case 29:
                _context2.prev = 29;
                _context2.t1 = _context2["catch"](12);
                console.error("\u5904\u7406\u5DF2\u53D6\u6D88\u9884\u7EA6 ".concat(booking._id, " \u51FA\u9519:"), _context2.t1);
              case 32:
                _context2.next = 10;
                break;
              case 34:
                _context2.next = 39;
                break;
              case 36:
                _context2.prev = 36;
                _context2.t2 = _context2["catch"](8);
                _iterator2.e(_context2.t2);
              case 39:
                _context2.prev = 39;
                _iterator2.f();
                return _context2.finish(39);
              case 42:
                // 保存最终的同步缓存
                if (syncCount > 0) {
                  uni.setStorageSync('synced_cancelled_ids', JSON.stringify(newSyncedIds));
                  console.log("\u672C\u6B21\u5171\u540C\u6B65 ".concat(syncCount, " \u6761\u5DF2\u53D6\u6D88\u9884\u7EA6\uFF0C\u66F4\u65B0\u540C\u6B65\u7F13\u5B58"));
                }
              case 43:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, null, [[8, 36, 39, 42], [12, 29], [17, 24]]);
      }))();
    },
    // 获取预约状态文本
    getStatusText: function getStatusText(booking) {
      if (!booking) return '未知状态';

      // 检查是否有支付状态属性
      var paymentStatus = booking.paymentStatus || 'unpaid';

      // 如果退费，优先显示已退费
      if (paymentStatus === 'refunded') {
        return '已退费';
      }

      // 如果支付状态为已付款，优先显示已支付状态
      if (paymentStatus === 'paid') {
        return booking.status === 'confirmed' ? '已确认（已缴费）' : booking.status === 'finished' ? '已完成' : booking.status === 'cancelled' ? '已取消' : '已缴费';
      }

      // 根据预约状态返回文本
      switch (booking.status) {
        case 'pending':
          return '待确认（未缴费）';
        case 'confirmed_unpaid':
          return '已确认（未缴费）';
        case 'confirmed':
          return paymentStatus === 'paid' ? '已确认（已缴费）' : '已确认（未缴费）';
        case 'finished':
          return '已完成';
        case 'cancelled':
        case 'cancel':
          // 兼容旧版数据
          return '已取消';
        default:
          return '未知状态';
      }
    },
    // 格式化课程时间
    formatCourseTime: function formatCourseTime(item) {
      // 如果有courseTime字段，优先使用该字段
      if (item.courseTime) {
        return item.courseTime;
      }

      // 日期范围格式化
      var formatDateRange = function formatDateRange() {
        // 确保有日期数据
        if (!item.courseStartDate && !item.courseEndDate) {
          return '';
        }

        // 格式化单个日期
        var formatDate = function formatDate(dateStr) {
          try {
            if (!dateStr) return '';
            var date = new Date(dateStr);
            if (isNaN(date.getTime())) {
              return dateStr;
            }
            return "".concat(date.getFullYear(), "-").concat((date.getMonth() + 1).toString().padStart(2, '0'), "-").concat(date.getDate().toString().padStart(2, '0'));
          } catch (e) {
            return dateStr;
          }
        };

        // 如果有开始和结束日期，显示范围
        if (item.courseStartDate && item.courseEndDate) {
          return "".concat(formatDate(item.courseStartDate), "\u81F3").concat(formatDate(item.courseEndDate));
        } else if (item.courseStartDate) {
          return formatDate(item.courseStartDate);
        } else if (item.courseEndDate) {
          return formatDate(item.courseEndDate);
        }
        return '';
      };

      // 时间段格式化
      var formatTimeRange = function formatTimeRange() {
        // 确保有时间数据
        if (!item.courseStartTime && !item.courseEndTime) {
          return '';
        }

        // 处理简单的时间字符串
        var formatTime = function formatTime(timeStr) {
          if (!timeStr) return '';

          // 如果是简单的时间字符串，直接返回
          if (typeof timeStr === 'string' && (timeStr.includes(':') || timeStr.match(/^\d{1,2}:\d{2}$/))) {
            return timeStr;
          }

          // 如果是日期时间，提取时间部分
          try {
            var date = new Date(timeStr);
            if (!isNaN(date.getTime())) {
              return "".concat(date.getHours().toString().padStart(2, '0'), ":").concat(date.getMinutes().toString().padStart(2, '0'));
            }
          } catch (e) {
            // 忽略错误
          }
          return timeStr;
        };

        // 如果有开始和结束时间，显示范围
        if (item.courseStartTime && item.courseEndTime) {
          return "".concat(formatTime(item.courseStartTime), "-").concat(formatTime(item.courseEndTime));
        } else if (item.courseStartTime) {
          return formatTime(item.courseStartTime);
        } else if (item.courseEndTime) {
          return formatTime(item.courseEndTime);
        }
        return '';
      };

      // 组合日期和时间
      var dateRange = formatDateRange();
      var timeRange = formatTimeRange();
      if (dateRange && timeRange) {
        return "".concat(dateRange, " ").concat(timeRange);
      } else if (dateRange) {
        return dateRange;
      } else if (timeRange) {
        return timeRange;
      }

      // 处理原始的startTime和endTime（如果存在）
      if (item.startTime || item.endTime) {
        try {
          var formatFullDateTime = function formatFullDateTime(dateTimeStr) {
            if (!dateTimeStr) return '';
            var date = new Date(dateTimeStr);
            if (isNaN(date.getTime())) {
              return dateTimeStr;
            }
            var dateStr = "".concat(date.getFullYear(), "-").concat((date.getMonth() + 1).toString().padStart(2, '0'), "-").concat(date.getDate().toString().padStart(2, '0'));
            var timeStr = "".concat(date.getHours().toString().padStart(2, '0'), ":").concat(date.getMinutes().toString().padStart(2, '0'));
            return "".concat(dateStr, " ").concat(timeStr);
          };
          if (item.startTime && item.endTime) {
            return "".concat(formatFullDateTime(item.startTime), "\u81F3").concat(formatFullDateTime(item.endTime));
          } else if (item.startTime) {
            return formatFullDateTime(item.startTime);
          } else if (item.endTime) {
            return formatFullDateTime(item.endTime);
          }
        } catch (e) {
          console.error('格式化完整日期时间出错:', e);
        }
      }
      return '暂无';
    },
    // 格式化预约时间
    formatBookingTime: function formatBookingTime(timeStr) {
      if (!timeStr) return '';
      var date = new Date(timeStr);
      return "".concat(date.getFullYear(), "-").concat((date.getMonth() + 1).toString().padStart(2, '0'), "-").concat(date.getDate().toString().padStart(2, '0'), " ").concat(date.getHours().toString().padStart(2, '0'), ":").concat(date.getMinutes().toString().padStart(2, '0'));
    },
    // 查看预约详情
    viewDetail: function viewDetail(booking, event) {
      // 检查点击事件的数据
      try {
        // 如果booking为空，尝试从事件对象中获取数据
        if (!booking) {
          var eventTarget = event && event.currentTarget;
          if (eventTarget) {
            var bookingId = eventTarget.dataset.bookingId;
            var courseId = eventTarget.dataset.courseId;
            console.log('从事件对象获取数据:', {
              bookingId: bookingId,
              courseId: courseId
            });

            // 如果可以直接获取课程ID，则直接跳转
            if (courseId) {
              this.navigateToCourse(courseId);
              return;
            }

            // 如果只有预约ID，则跳转到预约详情
            if (bookingId) {
              uni.navigateTo({
                url: "/pages/user/booking-detail?id=".concat(bookingId)
              });
              return;
            }
          }
          console.warn('预约数据为空，无法处理点击事件');
          return;
        }

        // 检查booking参数是否有效
        if ((0, _typeof2.default)(booking) !== 'object') {
          console.error('无效的预约数据类型:', (0, _typeof2.default)(booking));
          uni.showToast({
            title: '无效的预约数据',
            icon: 'none'
          });
          return;
        }

        // 确保booking对象有_id或courseId至少一个
        if (!booking._id && !booking.courseId) {
          console.error('预约数据缺少必要字段:', booking);
          uni.showToast({
            title: '无效的预约数据',
            icon: 'none'
          });
          return;
        }

        // 如果存在课程ID，则直接跳转到课程详情页
        if (booking.courseId) {
          console.log('跳转到课程详情页:', booking.courseId);
          this.navigateToCourse(booking.courseId);
          return;
        }

        // 否则跳转到预约详情页
        console.log('跳转到预约详情页:', booking._id);
        uni.navigateTo({
          url: "/pages/user/booking-detail?id=".concat(booking._id)
        });
      } catch (error) {
        console.error('处理预约点击事件出错:', error);
        uni.showToast({
          title: '处理失败，请重试',
          icon: 'none'
        });
      }
    },
    // 取消预约
    cancelBooking: function cancelBooking(booking, e) {
      var _this5 = this;
      // 阻止事件冒泡（使用传入的事件参数e）
      if (e) e.stopPropagation();

      // 确保booking参数存在且有效
      if (!booking || (0, _typeof2.default)(booking) !== 'object') {
        console.error('无效的预约数据:', booking);
        uni.showToast({
          title: '无效的预约数据',
          icon: 'none'
        });
        return;
      }

      // 检查支付状态
      var hasPaid = booking.paymentStatus === 'paid' || booking.isPaid === true;

      // 确认是否取消
      uni.showModal({
        title: '取消预约',
        content: hasPaid ? '您已完成缴费，确定要取消此次预约吗？' : '确定要取消此次预约吗？',
        success: function () {
          var _success = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(res) {
            return _regenerator.default.wrap(function _callee3$(_context3) {
              while (1) {
                switch (_context3.prev = _context3.next) {
                  case 0:
                    if (res.confirm) {
                      _this5.handleCancel(booking);
                    }
                  case 1:
                  case "end":
                    return _context3.stop();
                }
              }
            }, _callee3);
          }));
          function success(_x) {
            return _success.apply(this, arguments);
          }
          return success;
        }()
      });
    },
    // 新增处理取消操作的方法
    handleCancel: function handleCancel(booking) {
      var _this6 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4() {
        var userInfoStr, userId, userInfo, bookingDocId, updateSuccess, cloudResult, updateResult, _updateResult$result, forceResult, _updateResult, db, _updateResult2, _updateResult3, previousStatus, previouslyCancelled, cancelledBooking, existingIndex;
        return _regenerator.default.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                console.log('准备取消预约:', JSON.stringify(booking));
                _context4.prev = 1;
                uni.showLoading({
                  title: '取消中...'
                });

                // 获取当前用户ID，提高安全性
                userInfoStr = uni.getStorageSync('userInfo');
                userId = '';
                if (userInfoStr) {
                  try {
                    // 检查是否已经是对象
                    userInfo = typeof userInfoStr === 'string' ? JSON.parse(userInfoStr) : userInfoStr;
                    userId = userInfo.userId || userInfo._id || userInfo.uid || userInfo.userInfo && userInfo.userInfo._id || userInfo.userInfo && userInfo.userInfo.uid || '';
                  } catch (e) {
                    console.error('解析用户信息失败:', e);
                  }
                }

                // 确保bookingDocId有值
                bookingDocId = booking._id || '';
                if (bookingDocId) {
                  _context4.next = 12;
                  break;
                }
                console.error('预约ID无效:', booking);
                uni.showToast({
                  title: '预约ID无效',
                  icon: 'none'
                });
                uni.hideLoading();
                return _context4.abrupt("return");
              case 12:
                console.log('取消预约:', {
                  _id: bookingDocId,
                  bookingId: booking.bookingId || '',
                  courseId: booking.courseId || '',
                  userId: userId,
                  bookingUserId: booking.userId || '',
                  status: booking.status || 'unknown'
                });
                updateSuccess = false; // 尝试方法1：使用cancelBooking云函数
                _context4.prev = 14;
                console.log('尝试方法1：使用cancelBooking云函数');
                _context4.next = 18;
                return uniCloud.callFunction({
                  name: 'cancelBooking',
                  data: {
                    bookingId: bookingDocId,
                    userId: userId
                  }
                });
              case 18:
                cloudResult = _context4.sent;
                console.log('方法1结果:', JSON.stringify(cloudResult.result));
                if (!(cloudResult.result && cloudResult.result.success)) {
                  _context4.next = 40;
                  break;
                }
                updateSuccess = true;
                console.log('方法1成功：使用cancelBooking云函数更新成功');

                // 检查课程更新状态
                if (!(cloudResult.result.data && cloudResult.result.data.courseUpdated !== undefined)) {
                  _context4.next = 40;
                  break;
                }
                console.log('课程更新状态:', cloudResult.result.data.courseUpdated ? '成功' : '失败');
                if (cloudResult.result.data.courseUpdated) {
                  _context4.next = 40;
                  break;
                }
                console.warn('❌ 警告: 预约已取消，但课程报名人数可能未减少，尝试直接更新');

                // 如果课程bookingCount未更新，尝试使用forceUpdateBooking云函数直接更新
                if (!booking.courseId) {
                  _context4.next = 40;
                  break;
                }
                _context4.prev = 28;
                console.log('尝试使用forceUpdateBooking云函数直接更新课程报名人数, 课程ID:', booking.courseId);
                _context4.next = 32;
                return uniCloud.callFunction({
                  name: 'forceUpdateBooking',
                  data: {
                    courseId: booking.courseId,
                    updateCourseOnly: true,
                    decreaseBookingCount: true
                  }
                });
              case 32:
                updateResult = _context4.sent;
                console.log('直接更新课程报名人数结果:', JSON.stringify(updateResult.result));
                if (updateResult.result && updateResult.result.code === 0) {
                  console.log('✅ 直接更新课程报名人数成功');
                } else {
                  console.warn('❌ 直接更新课程报名人数失败:', ((_updateResult$result = updateResult.result) === null || _updateResult$result === void 0 ? void 0 : _updateResult$result.message) || '未知错误');
                }
                _context4.next = 40;
                break;
              case 37:
                _context4.prev = 37;
                _context4.t0 = _context4["catch"](28);
                console.error('直接更新课程报名人数失败:', _context4.t0);
              case 40:
                _context4.next = 45;
                break;
              case 42:
                _context4.prev = 42;
                _context4.t1 = _context4["catch"](14);
                console.error('方法1失败:', _context4.t1);
              case 45:
                if (updateSuccess) {
                  _context4.next = 76;
                  break;
                }
                _context4.prev = 46;
                console.log('尝试方法2：使用forceUpdateBooking云函数');
                _context4.next = 50;
                return uniCloud.callFunction({
                  name: 'forceUpdateBooking',
                  data: {
                    bookingId: bookingDocId,
                    status: 'cancelled',
                    updateCourseCount: true // 确保更新课程报名人数
                  }
                });
              case 50:
                forceResult = _context4.sent;
                console.log('方法2结果:', JSON.stringify(forceResult.result));
                if (!(forceResult.result && forceResult.result.success)) {
                  _context4.next = 70;
                  break;
                }
                updateSuccess = true;
                console.log('方法2成功：使用forceUpdateBooking云函数更新成功');

                // 检查课程更新状态，如果未更新，则尝试直接更新
                if (!(forceResult.result.data && forceResult.result.data.courseUpdated !== undefined && !forceResult.result.data.courseUpdated)) {
                  _context4.next = 68;
                  break;
                }
                if (!booking.courseId) {
                  _context4.next = 68;
                  break;
                }
                _context4.prev = 57;
                console.log('尝试使用forceUpdateBooking云函数直接更新课程报名人数, 课程ID:', booking.courseId);
                _context4.next = 61;
                return uniCloud.callFunction({
                  name: 'forceUpdateBooking',
                  data: {
                    courseId: booking.courseId,
                    updateCourseOnly: true,
                    decreaseBookingCount: true
                  }
                });
              case 61:
                _updateResult = _context4.sent;
                console.log('直接更新课程报名人数结果:', JSON.stringify(_updateResult.result));
                _context4.next = 68;
                break;
              case 65:
                _context4.prev = 65;
                _context4.t2 = _context4["catch"](57);
                console.error('直接更新课程报名人数失败:', _context4.t2);
              case 68:
                _context4.next = 71;
                break;
              case 70:
                console.error('方法2失败，返回结果:', forceResult.result);
              case 71:
                _context4.next = 76;
                break;
              case 73:
                _context4.prev = 73;
                _context4.t3 = _context4["catch"](46);
                console.error('方法2失败，错误信息:', _context4.t3);
              case 76:
                if (updateSuccess) {
                  _context4.next = 104;
                  break;
                }
                _context4.prev = 77;
                console.log('尝试方法3：直接操作数据库');
                db = uniCloud.database();
                _context4.next = 82;
                return db.collection('bookings').doc(bookingDocId).update({
                  status: 'cancelled',
                  updateTime: new Date(),
                  cancelTime: new Date()
                });
              case 82:
                _updateResult2 = _context4.sent;
                console.log('方法3结果:', _updateResult2);
                if (!(_updateResult2 && _updateResult2.updated > 0)) {
                  _context4.next = 99;
                  break;
                }
                updateSuccess = true;
                console.log('方法3成功：直接更新数据库成功');

                // 更新课程报名人数，使用forceUpdateBooking云函数
                if (!booking.courseId) {
                  _context4.next = 99;
                  break;
                }
                _context4.prev = 88;
                console.log('尝试使用forceUpdateBooking云函数直接更新课程报名人数, 课程ID:', booking.courseId);
                _context4.next = 92;
                return uniCloud.callFunction({
                  name: 'forceUpdateBooking',
                  data: {
                    courseId: booking.courseId,
                    updateCourseOnly: true,
                    decreaseBookingCount: true
                  }
                });
              case 92:
                _updateResult3 = _context4.sent;
                console.log('直接更新课程报名人数结果:', JSON.stringify(_updateResult3.result));
                _context4.next = 99;
                break;
              case 96:
                _context4.prev = 96;
                _context4.t4 = _context4["catch"](88);
                console.error('更新课程报名人数失败:', _context4.t4);
              case 99:
                _context4.next = 104;
                break;
              case 101:
                _context4.prev = 101;
                _context4.t5 = _context4["catch"](77);
                console.error('方法3失败:', _context4.t5);
              case 104:
                // 无论是否成功更新数据库，都更新本地状态
                if (updateSuccess) {
                  uni.showToast({
                    title: '取消成功',
                    icon: 'success'
                  });
                } else {
                  console.log('云端更新失败，仅更新本地状态');
                  uni.showToast({
                    title: '取消成功(仅本地)',
                    icon: 'success'
                  });
                }

                // 更新预约状态计数（无论是否成功更新服务器）
                previousStatus = booking.status || 'unknown'; // 如果之前是已预约状态，减少已预约计数
                if (previousStatus !== 'cancelled' && (previousStatus === 'pending' || previousStatus === 'confirmed_unpaid' || previousStatus === 'confirmed')) {
                  _this6.statusCounts.booked = Math.max(0, _this6.statusCounts.booked - 1);
                }
                // 如果之前是已完成状态，减少已完成计数
                else if (previousStatus === 'finished') {
                  _this6.statusCounts.finished = Math.max(0, _this6.statusCounts.finished - 1);
                }

                // 增加已取消计数，确保不重复计算
                previouslyCancelled = booking.status === 'cancelled';
                if (!previouslyCancelled) {
                  _this6.statusCounts.cancelled++;
                }

                // 在内存中更新预约状态
                _this6.updateBookingStatus(bookingDocId, 'cancelled');

                // 如果当前不是"已取消"选项卡，从当前列表中移除该项
                if (_this6.currentStatus !== 'cancelled') {
                  _this6.removeBookingFromList(bookingDocId);

                  // 提示用户可以在"已取消"标签查看
                  setTimeout(function () {
                    uni.showToast({
                      title: "\u5DF2\u53D6\u6D88\uFF0C\u53EF\u5728\"\u5DF2\u53D6\u6D88(".concat(_this6.getTabCount('cancelled'), ")\"\u6807\u7B7E\u67E5\u770B"),
                      icon: 'none',
                      duration: 2000
                    });
                  }, 1500);
                }

                // 保存到本地存储
                cancelledBooking = _objectSpread(_objectSpread({}, booking), {}, {
                  status: 'cancelled',
                  cancelTime: new Date().toISOString()
                });
                _this6.storeCancelledBooking(cancelledBooking);

                // 标记预约状态已变更
                _this6.markBookingChanged();

                // 发送取消事件，更新相关页面
                uni.$emit('booking:cancel', {
                  courseId: booking.courseId || '',
                  userId: userId,
                  bookingId: bookingDocId
                });

                // 如果当前在"已取消"标签页，重新加载列表以显示最新数据
                if (_this6.currentStatus === 'cancelled') {
                  // 将刚刚取消的预约添加到列表头部
                  if (cancelledBooking && cancelledBooking._id) {
                    // 避免重复添加
                    existingIndex = _this6.bookingList.findIndex(function (item) {
                      return item && item._id === cancelledBooking._id;
                    });
                    if (existingIndex === -1) {
                      console.log('在已取消标签中添加最新取消的预约记录到头部');
                      _this6.bookingList.unshift(cancelledBooking);
                      _this6.total = _this6.bookingList.length;
                      _this6.$forceUpdate();
                    } else {
                      console.log('预约记录已存在于列表中，更新状态');
                      _this6.bookingList[existingIndex].status = 'cancelled';
                      _this6.$forceUpdate();
                    }
                  } else {
                    // 如果无法直接添加，则重新加载整个列表
                    console.log('无法直接添加取消的预约，刷新整个列表');
                    _this6.resetList();
                    _this6.loadBookingList();
                  }
                }
                _context4.next = 122;
                break;
              case 118:
                _context4.prev = 118;
                _context4.t6 = _context4["catch"](1);
                console.error('取消预约失败:', _context4.t6);
                uni.showToast({
                  title: '取消失败，请稍后重试',
                  icon: 'none'
                });
              case 122:
                _context4.prev = 122;
                uni.hideLoading();
                return _context4.finish(122);
              case 125:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, null, [[1, 118, 122, 125], [14, 42], [28, 37], [46, 73], [57, 65], [77, 101], [88, 96]]);
      }))();
    },
    // 联系老师
    contactTeacher: function contactTeacher(booking, e) {
      // 阻止事件冒泡
      if (e) e.stopPropagation();

      // 检查参数有效性
      if (!booking || (0, _typeof2.default)(booking) !== 'object') {
        console.error('无效的预约数据:', booking);
        uni.showToast({
          title: '无效的预约数据',
          icon: 'none'
        });
        return;
      }

      // 检查是否有联系电话
      var phoneNumber = booking.contactPhone || booking.teacherPhone || '';
      if (!phoneNumber) {
        uni.showToast({
          title: '暂无联系方式',
          icon: 'none'
        });
        return;
      }
      uni.makePhoneCall({
        phoneNumber: phoneNumber,
        fail: function fail() {
          uni.showToast({
            title: '拨打电话失败',
            icon: 'none'
          });
        }
      });
    },
    // 查看课程详情
    navigateToCourse: function navigateToCourse(courseId, e) {
      // 阻止事件冒泡
      if (e) e.stopPropagation();

      // 检查参数有效性
      if (!courseId) {
        console.error('无效的课程ID:', courseId);
        uni.showToast({
          title: '无效的课程ID',
          icon: 'none'
        });
        return;
      }

      // 检查课程ID是否为有效的MongoDB ObjectId格式
      if (typeof courseId !== 'string' || courseId.length !== 24) {
        console.warn('课程ID格式可能不正确:', courseId);
      }

      // 跳转到课程详情页
      uni.navigateTo({
        url: "/pages/course/detail?id=".concat(courseId)
      });
    },
    // 存储已取消的预约
    storeCancelledBooking: function storeCancelledBooking(booking) {
      try {
        // 参数检查
        if (!booking || (0, _typeof2.default)(booking) !== 'object') {
          console.error('存储已取消预约失败: 无效的预约数据', booking);
          return;
        }

        // 确保booking有_id字段
        if (!booking._id) {
          console.error('无法保存没有_id的预约记录', booking);
          return;
        }

        // 深拷贝booking对象，避免引用问题
        var bookingCopy = JSON.parse(JSON.stringify(booking));

        // 确保booking有完整的信息
        bookingCopy.status = 'cancelled';

        // 设置cancelTime
        bookingCopy.cancelTime = bookingCopy.cancelTime || new Date().toISOString();

        // 保留或设置取消原因
        if (!bookingCopy.cancelReason && bookingCopy.autoCancel) {
          bookingCopy.cancelReason = '超时未支付，系统自动取消';
        }

        // 如果有cancelReason但没有autoCancel标记，设置标记
        if (bookingCopy.cancelReason === '超时未支付，系统自动取消' && !bookingCopy.autoCancel) {
          bookingCopy.autoCancel = true;
        }
        console.log('准备保存已取消预约:', JSON.stringify({
          _id: bookingCopy._id,
          status: bookingCopy.status,
          autoCancel: bookingCopy.autoCancel,
          cancelReason: bookingCopy.cancelReason
        }));

        // 构建存储键名
        var key = "cancelled_booking_".concat(bookingCopy._id);

        // 检查是否已经存储过
        var existingData = uni.getStorageSync(key);
        var isNewStorage = !existingData;

        // 保存已取消的预约数据
        uni.setStorageSync(key, JSON.stringify(bookingCopy));

        // 只有首次存储才打印日志和执行后续逻辑
        if (isNewStorage) {
          console.log('已保存已取消预约数据:', bookingCopy._id);

          // 记录最近取消的预约ID列表
          var cancelledIds = uni.getStorageSync('cancelled_booking_ids') || '[]';
          try {
            cancelledIds = JSON.parse(cancelledIds);
            if (!Array.isArray(cancelledIds)) {
              cancelledIds = [];
            }
          } catch (e) {
            console.error('解析已取消预约ID列表失败:', e);
            cancelledIds = [];
          }

          // 检查是否已经存在
          var alreadyExists = cancelledIds.includes(bookingCopy._id);

          // 添加到列表头部（如果不存在）
          if (!alreadyExists) {
            cancelledIds.unshift(bookingCopy._id);
            // 最多保存20条
            if (cancelledIds.length > 20) {
              cancelledIds = cancelledIds.slice(0, 20);
            }

            // 更新计数和标记
            this.statusCounts.cancelled = cancelledIds.length;
            this.localCancelledLoaded = true;

            // 保存更新后的ID列表
            uni.setStorageSync('cancelled_booking_ids', JSON.stringify(cancelledIds));

            // 如果是通过按钮取消的预约，且不在已取消标签页，延迟后切换到已取消标签
            if (this.currentStatus !== 'cancelled' && !this.autoSwitchToCancel) {
              this.switchToCancelledTab();
            }
          }
        } else {
          // 即使已存在，仍然更新信息确保autoCancel和cancelReason正确
          console.log('更新已存在的已取消预约数据:', bookingCopy._id);
        }
      } catch (e) {
        console.error('保存已取消预约数据失败:', e);
      }
      return true;
    },
    // 切换到已取消标签页
    switchToCancelledTab: function switchToCancelledTab() {
      var _this7 = this;
      setTimeout(function () {
        uni.showToast({
          title: '正在前往已取消列表',
          icon: 'none',
          duration: 1500
        });
        setTimeout(function () {
          _this7.changeTab('cancelled');
        }, 1500);
      }, 800);
    },
    // 获取空数据提示文本
    getEmptyTipText: function getEmptyTipText() {
      switch (this.currentStatus) {
        case 'all':
          return '暂无任何预约记录';
        case 'booked':
          return '暂无进行中的预约';
        case 'finished':
          return '暂无已完成的预约';
        case 'cancelled':
          return '暂无已取消的预约记录';
        case 'refunded':
          return '暂无已退费的预约记录';
        default:
          return '暂无预约记录';
      }
    },
    // 获取标签对应的预约数量
    getTabCount: function getTabCount(status) {
      // 使用缓存的数量
      return this.statusCounts[status] || 0;
    },
    // 辅助方法：检查存储中是否存在特定自动取消的预约ID
    getAutoCancelledBookingIds: function getAutoCancelledBookingIds() {
      try {
        // 获取已取消预约ID列表
        var cancelledIds = uni.getStorageSync('cancelled_booking_ids') || '[]';
        cancelledIds = typeof cancelledIds === 'string' ? JSON.parse(cancelledIds) : cancelledIds;
        if (!Array.isArray(cancelledIds) || !cancelledIds.length) {
          return [];
        }

        // 筛选出自动取消的预约ID
        var autoCancelIds = [];
        var _iterator3 = _createForOfIteratorHelper(cancelledIds),
          _step3;
        try {
          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {
            var id = _step3.value;
            try {
              var key = "cancelled_booking_".concat(id);
              var bookingStr = uni.getStorageSync(key);
              if (bookingStr) {
                var booking = typeof bookingStr === 'string' ? JSON.parse(bookingStr) : bookingStr;
                if (booking.autoCancel === true || booking.cancelReason === '超时未支付，系统自动取消') {
                  autoCancelIds.push(id);
                }
              }
            } catch (e) {
              console.error("\u83B7\u53D6\u9884\u7EA6 ".concat(id, " \u81EA\u52A8\u53D6\u6D88\u72B6\u6001\u5931\u8D25:"), e);
            }
          }
        } catch (err) {
          _iterator3.e(err);
        } finally {
          _iterator3.f();
        }
        console.log("\u627E\u5230 ".concat(autoCancelIds.length, " \u4E2A\u81EA\u52A8\u53D6\u6D88\u7684\u9884\u7EA6ID"));
        return autoCancelIds;
      } catch (e) {
        console.error('获取自动取消预约ID列表失败:', e);
        return [];
      }
    },
    // 加载本地已取消记录数量
    loadLocalCancelledCount: function loadLocalCancelledCount() {
      if (this.localCancelledLoaded) return;
      try {
        var userInfoStr = uni.getStorageSync('userInfo');
        if (userInfoStr) {
          // 检查是否已经是对象
          var userData = typeof userInfoStr === 'string' ? JSON.parse(userInfoStr) : userInfoStr;
          var userId = userData.userId || userData._id || userData.uid || userData.userInfo && userData.userInfo._id || userData.userInfo && userData.userInfo.uid || '';
          if (userId) {
            var cancelledIds = uni.getStorageSync('cancelled_booking_ids') || '[]';
            try {
              // 检查是否已经是数组
              var ids = typeof cancelledIds === 'string' ? JSON.parse(cancelledIds) : cancelledIds;
              if (Array.isArray(ids)) {
                this.statusCounts.cancelled = ids.length;
                this.localCancelledLoaded = true;
                console.log("\u52A0\u8F7D\u5230".concat(ids.length, "\u6761\u672C\u5730\u5DF2\u53D6\u6D88\u9884\u7EA6"));
              }
            } catch (e) {
              console.error('解析已取消预约ID列表失败:', e);
            }
          }
        }
      } catch (e) {
        console.error('加载本地已取消预约数量失败:', e);
      }
    },
    // 更新预约状态
    updateBookingStatus: function updateBookingStatus(bookingId, status) {
      if (!bookingId || !status) return;
      console.log("\u66F4\u65B0\u9884\u7EA6".concat(bookingId, "\u72B6\u6001\u4E3A").concat(status));

      // 查找匹配的预约
      var index = this.bookingList.findIndex(function (item) {
        return item && item._id === bookingId;
      });
      if (index !== -1) {
        console.log("\u627E\u5230\u9884\u7EA6\u5728\u5217\u8868\u4E2D\u7684\u4F4D\u7F6E: ".concat(index, ", \u66F4\u65B0\u72B6\u6001"));
        this.bookingList[index].status = status;
        this.$forceUpdate();
      } else {
        console.log("\u672A\u5728\u5F53\u524D\u5217\u8868\u4E2D\u627E\u5230\u9884\u7EA6: ".concat(bookingId));
      }
    },
    // 从列表中移除预约
    removeBookingFromList: function removeBookingFromList(bookingId) {
      if (!bookingId) return;
      console.log("\u4ECE\u5217\u8868\u4E2D\u79FB\u9664\u9884\u7EA6: ".concat(bookingId));

      // 查找匹配的预约
      var index = this.bookingList.findIndex(function (item) {
        return item && item._id === bookingId;
      });
      if (index !== -1) {
        console.log("\u627E\u5230\u9884\u7EA6\u5728\u5217\u8868\u4E2D\u7684\u4F4D\u7F6E: ".concat(index, ", \u79FB\u9664\u5B83"));
        this.bookingList.splice(index, 1);
        this.total = Math.max(0, this.total - 1);
        this.$forceUpdate();
      } else {
        console.log("\u672A\u5728\u5F53\u524D\u5217\u8868\u4E2D\u627E\u5230\u9884\u7EA6: ".concat(bookingId));
      }
    },
    // 标记预约状态已变更
    markBookingChanged: function markBookingChanged() {
      console.log('标记预约状态已变更');
      uni.setStorageSync('booking_changed', 'true');
    },
    // 获取用户ID
    getUserId: function getUserId() {
      try {
        var userInfoStr = uni.getStorageSync('userInfo');
        if (userInfoStr) {
          // 检查是否已经是对象
          var userInfo = typeof userInfoStr === 'string' ? JSON.parse(userInfoStr) : userInfoStr;
          return userInfo.userId || userInfo._id || userInfo.uid || userInfo.userInfo && userInfo.userInfo._id || userInfo.userInfo && userInfo.userInfo.uid || '';
        }
      } catch (e) {
        console.error('获取用户ID失败:', e);
      }
      return '';
    },
    // 在methods部分添加检查是否显示操作按钮的方法
    showActions: function showActions(item) {
      return item && (item.status !== 'cancelled' && item.status !== 'finished' || item.status === 'confirmed' || item.status === 'confirmed_unpaid' || item.status !== 'cancelled');
    },
    // 判断是否应该显示联系老师按钮
    shouldShowContactButton: function shouldShowContactButton(item) {
      if (!item) return false;

      // 判断是否已支付
      var isPaid = item.paymentStatus === 'paid' || item.isPaid === true;

      // 只有当状态为已确认但未缴费时才显示联系老师按钮
      return item.status === 'confirmed' && !isPaid || item.status === 'confirmed_unpaid';
    },
    // 判断是否应该显示去缴费按钮
    shouldShowPayButton: function shouldShowPayButton(item) {
      if (!item) return false;

      // 检查支付状态 - 未支付、非取消、非已完成、非退费状态时显示
      var isUnpaid = item.paymentStatus !== 'paid' && item.paymentStatus !== 'refunded';
      var isPayable = item.status === 'pending' || item.status === 'confirmed_unpaid' || item.status === 'confirmed' && !item.isPaid;
      return isUnpaid && isPayable;
    },
    // 前往支付页面
    goToPay: function goToPay(booking, e) {
      // 阻止事件冒泡，避免触发viewDetail
      if (e) e.stopPropagation();
      if (!booking || !booking._id) {
        console.error('无法支付：预约ID无效');
        uni.showToast({
          title: '预约ID无效',
          icon: 'none'
        });
        return;
      }

      // 跳转到支付页面
      uni.navigateTo({
        url: "/pages/payment/index?bookingId=".concat(booking._id, "&courseId=").concat(booking.courseId || '')
      });
    },
    // 处理申请退费
    handleRefund: function handleRefund(booking, e) {
      var _this8 = this;
      // 阻止事件冒泡，避免触发viewDetail
      if (e) e.stopPropagation();
      if (!booking || !booking._id) {
        console.error('无法申请退费：预约ID无效');
        uni.showToast({
          title: '预约ID无效',
          icon: 'none'
        });
        return;
      }

      // 确认是否退费
      uni.showModal({
        title: '申请退费',
        content: '确认要申请退费吗？退费后将无法恢复。',
        success: function () {
          var _success2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5(res) {
            var userId, result, _result$result;
            return _regenerator.default.wrap(function _callee5$(_context5) {
              while (1) {
                switch (_context5.prev = _context5.next) {
                  case 0:
                    if (!res.confirm) {
                      _context5.next = 22;
                      break;
                    }
                    uni.showLoading({
                      title: '处理中...'
                    });
                    _context5.prev = 2;
                    // 获取当前用户ID
                    userId = _this8.getUserId();
                    if (userId) {
                      _context5.next = 8;
                      break;
                    }
                    uni.showToast({
                      title: '用户未登录',
                      icon: 'none'
                    });
                    uni.hideLoading();
                    return _context5.abrupt("return");
                  case 8:
                    _context5.next = 10;
                    return uniCloud.callFunction({
                      name: 'refundBookingPayment',
                      data: {
                        bookingId: booking._id,
                        userId: userId,
                        refundReason: '用户申请退款'
                      }
                    });
                  case 10:
                    result = _context5.sent;
                    console.log('退款处理结果:', result);
                    if (result.result && result.result.success) {
                      // 更新本地数据
                      booking.paymentStatus = 'refunded';
                      booking.refundTime = new Date();
                      booking.refundReason = '用户申请退款';

                      // 设置标记，通知列表页刷新
                      _this8.markBookingChanged();
                      uni.showToast({
                        title: '退费申请已处理',
                        icon: 'success'
                      });

                      // 刷新页面数据
                      setTimeout(function () {
                        _this8.resetList();
                        _this8.loadBookingList();
                      }, 1500);
                    } else {
                      uni.showToast({
                        title: ((_result$result = result.result) === null || _result$result === void 0 ? void 0 : _result$result.message) || '处理失败',
                        icon: 'none'
                      });
                    }
                    _context5.next = 19;
                    break;
                  case 15:
                    _context5.prev = 15;
                    _context5.t0 = _context5["catch"](2);
                    console.error('退款处理出错:', _context5.t0);
                    uni.showToast({
                      title: '处理失败，请重试',
                      icon: 'none'
                    });
                  case 19:
                    _context5.prev = 19;
                    uni.hideLoading();
                    return _context5.finish(19);
                  case 22:
                  case "end":
                    return _context5.stop();
                }
              }
            }, _callee5, null, [[2, 15, 19, 22]]);
          }));
          function success(_x2) {
            return _success2.apply(this, arguments);
          }
          return success;
        }()
      });
    },
    // 判断是否应该显示倒计时
    shouldShowCountdown: function shouldShowCountdown(booking) {
      if (!booking || !booking._id) return false;

      // 如果已支付或已退费，不显示倒计时
      if (booking.paymentStatus === 'paid' || booking.paymentStatus === 'refunded') {
        return false;
      }

      // 检查状态是否为待支付
      var isPendingPayment = booking.status === 'pending' || booking.status === 'pending' && booking.paymentStatus === 'unpaid' || booking.status === 'confirmed_unpaid';

      // 获取倒计时值
      var countdown = this.getPaymentCountdown(booking);

      // 调试日志
      console.log("\u9884\u7EA6ID: ".concat(booking.bookingId, ", \u72B6\u6001: ").concat(booking.status, ", \u652F\u4ED8\u72B6\u6001: ").concat(booking.paymentStatus, ", \u5012\u8BA1\u65F6: ").concat(countdown, "\u79D2"));
      return isPendingPayment && countdown > 0;
    },
    // 初始化所有倒计时
    initAllCountdowns: function initAllCountdowns() {
      var _this9 = this;
      // 清除之前的所有定时器
      this.clearAllCountdowns();
      console.log('开始初始化所有倒计时, 预约数量:', this.bookingList.length);

      // 初始化所有待支付状态的预约倒计时
      if (Array.isArray(this.bookingList)) {
        var initCount = 0;
        this.bookingList.forEach(function (booking) {
          if (booking && (booking.status === 'pending' || booking.status === 'confirmed_unpaid')) {
            console.log('初始化预约倒计时:', booking.bookingId || booking._id);
            _this9.initCountdown(booking);
            initCount++;
          }
        });
        console.log("\u6210\u529F\u521D\u59CB\u5316 ".concat(initCount, " \u4E2A\u9884\u7EA6\u7684\u5012\u8BA1\u65F6"));
      }

      // 强制更新视图
      this.$forceUpdate();
    },
    // 初始化单个预约的倒计时
    initCountdown: function initCountdown(booking) {
      var _arguments = arguments,
        _this10 = this;
      if (!booking || !booking._id || booking.status !== 'pending' && booking.status !== 'confirmed_unpaid') {
        return;
      }

      // 如果已支付或已退费，不初始化倒计时
      if (booking.paymentStatus === 'paid' || booking.paymentStatus === 'refunded') {
        console.log("\u9884\u7EA6 ".concat(booking.bookingId || booking._id, " \u5DF2\u652F\u4ED8\u6216\u5DF2\u9000\u8D39\uFF0C\u4E0D\u521D\u59CB\u5316\u5012\u8BA1\u65F6"));
        return;
      }
      console.log("\u5F00\u59CB\u521D\u59CB\u5316\u9884\u7EA6 ".concat(booking.bookingId || booking._id, " \u7684\u5012\u8BA1\u65F6"));
      try {
        // 清除可能存在的定时器
        this.clearCountdown(booking._id);

        // 计算倒计时初始值（秒）
        var countdownValue = this.calculateRemainingTime(booking);
        console.log("\u8BA1\u7B97\u5F97\u5230\u5012\u8BA1\u65F6\u521D\u59CB\u503C: ".concat(countdownValue, "\u79D2"));
        if (countdownValue <= 0) {
          // 已超时，设置为0并自动取消
          this.handleExpiredBooking(booking);
          return;
        }

        // 设置初始倒计时值
        this.countdownValues[booking._id] = countdownValue;

        // 根据剩余时间设置更新频率（秒）
        var updateInterval = this.getUpdateInterval(countdownValue);

        // 云端检查频率（毫秒）- 每小时检查一次
        var cloudCheckInterval = 3600 * 1000;

        // 最后一次云端检查时间
        var lastCloudCheck = Date.now();

        // 创建定时器 - 使用单一定时器处理UI更新和云端检查
        this.countdownTimers[booking._id] = setInterval(function () {
          // 更新倒计时
          if (_this10.countdownValues[booking._id] > 0) {
            _this10.countdownValues[booking._id] -= updateInterval;

            // 检查是否需要调整更新频率
            var newInterval = _this10.getUpdateInterval(_this10.countdownValues[booking._id]);
            if (newInterval !== updateInterval) {
              console.log("\u9884\u7EA6 ".concat(booking.bookingId, " \u8C03\u6574\u66F4\u65B0\u9891\u7387: ").concat(updateInterval, "\u79D2 -> ").concat(newInterval, "\u79D2"));
              clearInterval(_this10.countdownTimers[booking._id]);
              updateInterval = newInterval;
              _this10.countdownTimers[booking._id] = setInterval(_arguments.callee, updateInterval * 1000);
            }

            // 记录日志 - 在更新频率变化点或每小时记录一次
            if (_this10.countdownValues[booking._id] % 3600 === 0 || _this10.countdownValues[booking._id] === 7200 ||
            // 剩余2小时
            _this10.countdownValues[booking._id] === 3600 ||
            // 剩余1小时
            _this10.countdownValues[booking._id] === 120) {
              // 剩余2分钟
              console.log("\u9884\u7EA6 ".concat(booking.bookingId, " \u5269\u4F59\u652F\u4ED8\u65F6\u95F4: ").concat(_this10.formatCountdown(_this10.countdownValues[booking._id])));
            }

            // 检查是否需要进行云端检查（每小时）
            var now = Date.now();
            if (now - lastCloudCheck >= cloudCheckInterval) {
              console.log("\u9884\u7EA6 ".concat(booking.bookingId, " \u6267\u884C\u6BCF\u5C0F\u65F6\u4E91\u7AEF\u68C0\u67E5"));
              _this10.checkBookingStatusFromCloud(booking._id);
              lastCloudCheck = now;
            }

            // 强制更新视图
            _this10.$forceUpdate();
          } else {
            // 倒计时结束，处理超时
            _this10.handleExpiredBooking(booking);
          }
        }, updateInterval * 1000); // 转换为毫秒
      } catch (e) {
        console.error('初始化倒计时异常:', e);
      }
    },
    // 根据剩余时间获取适当的更新间隔（秒）
    getUpdateInterval: function getUpdateInterval(remainingSeconds) {
      if (remainingSeconds > 7200) {
        // 大于2小时：每10分钟更新一次
        return 600;
      } else if (remainingSeconds > 3600) {
        // 1-2小时：每5分钟更新一次
        return 300;
      } else if (remainingSeconds > 120) {
        // 2分钟-1小时：每分钟更新一次
        return 60;
      } else {
        // 最后2分钟：每10秒更新一次
        return 10;
      }
    },
    // 处理超时预约
    handleExpiredBooking: function handleExpiredBooking(booking) {
      if (!booking || !booking._id) return;
      console.log("\u9884\u7EA6 ".concat(booking.bookingId || booking._id, " \u5DF2\u8D85\u65F6\uFF0C\u81EA\u52A8\u53D6\u6D88"));

      // 清除定时器
      this.clearCountdown(booking._id);

      // 设置倒计时为0
      this.countdownValues[booking._id] = 0;

      // 检查当前状态，避免重复处理
      if (booking.status === 'cancelled') {
        console.log('预约已经是取消状态，不再处理');
        return;
      }

      // 更新预约状态为已取消（超时）
      booking.status = 'cancelled';
      booking.autoCancel = true;
      booking.cancelReason = '超时未支付，系统自动取消';

      // 更新列表中的状态
      this.updateBookingStatus(booking._id, 'cancelled');

      // 保存到本地存储
      this.storeCancelledBooking(booking);

      // 显示提示
      uni.showToast({
        title: '预约已超时未支付，自动取消',
        icon: 'none',
        duration: 2000
      });

      // 标记预约状态已变更
      this.markBookingChanged();

      // 将超时状态同步到云端（限制频率）
      this.syncExpiredBookingToCloud(booking._id);

      // 刷新列表
      this.resetList();
      this.loadBookingList();
    },
    // 从云端检查预约状态
    checkBookingStatusFromCloud: function checkBookingStatusFromCloud(bookingId) {
      var _this11 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6() {
        var result, serverBooking, localBooking;
        return _regenerator.default.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                _context6.prev = 0;
                console.log("\u4ECE\u4E91\u7AEF\u68C0\u67E5\u9884\u7EA6\u72B6\u6001: ".concat(bookingId));

                // 调用云函数获取预约的最新状态
                _context6.next = 4;
                return uniCloud.callFunction({
                  name: 'getBookingStatus',
                  data: {
                    bookingId: bookingId
                  }
                });
              case 4:
                result = _context6.sent;
                if (result.result && result.result.success) {
                  serverBooking = result.result.data;
                  console.log("\u4E91\u7AEF\u8FD4\u56DE\u9884\u7EA6\u72B6\u6001:", serverBooking);

                  // 如果云端状态已更改，更新本地状态
                  if (serverBooking && serverBooking.status) {
                    localBooking = _this11.bookingList.find(function (b) {
                      return b._id === bookingId;
                    });
                    if (localBooking && localBooking.status !== serverBooking.status) {
                      console.log("\u66F4\u65B0\u672C\u5730\u9884\u7EA6\u72B6\u6001: ".concat(localBooking.status, " -> ").concat(serverBooking.status));
                      _this11.updateBookingStatus(bookingId, serverBooking.status);

                      // 如果状态为已取消，停止倒计时
                      if (serverBooking.status === 'cancelled') {
                        _this11.clearCountdown(bookingId);
                      }

                      // 刷新UI
                      _this11.$forceUpdate();
                    }
                  }
                }
                _context6.next = 11;
                break;
              case 8:
                _context6.prev = 8;
                _context6.t0 = _context6["catch"](0);
                console.error('从云端检查预约状态失败:', _context6.t0);
              case 11:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6, null, [[0, 8]]);
      }))();
    },
    // 将超时状态同步到云端（限制频率）
    syncExpiredBookingToCloud: function syncExpiredBookingToCloud(bookingId) {
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee7() {
        var key, isSynced, result;
        return _regenerator.default.wrap(function _callee7$(_context7) {
          while (1) {
            switch (_context7.prev = _context7.next) {
              case 0:
                // 检查是否已经同步过
                key = "synced_expired_".concat(bookingId);
                isSynced = uni.getStorageSync(key);
                if (!isSynced) {
                  _context7.next = 5;
                  break;
                }
                console.log("\u9884\u7EA6 ".concat(bookingId, " \u5DF2\u7ECF\u540C\u6B65\u8FC7\u8D85\u65F6\u72B6\u6001\uFF0C\u8DF3\u8FC7"));
                return _context7.abrupt("return");
              case 5:
                _context7.prev = 5;
                console.log("\u540C\u6B65\u9884\u7EA6 ".concat(bookingId, " \u7684\u8D85\u65F6\u72B6\u6001\u5230\u4E91\u7AEF"));

                // 调用云函数更新预约状态
                _context7.next = 9;
                return uniCloud.callFunction({
                  name: 'forceUpdateBooking',
                  data: {
                    bookingId: bookingId,
                    status: 'cancelled',
                    autoCancel: true,
                    cancelReason: '超时未支付，系统自动取消',
                    updateCourseCount: true
                  }
                });
              case 9:
                result = _context7.sent;
                if (result.result && result.result.success) {
                  console.log("\u540C\u6B65\u9884\u7EA6 ".concat(bookingId, " \u8D85\u65F6\u72B6\u6001\u6210\u529F"));
                  // 标记为已同步
                  uni.setStorageSync(key, 'true');
                } else {
                  console.error("\u540C\u6B65\u9884\u7EA6 ".concat(bookingId, " \u8D85\u65F6\u72B6\u6001\u5931\u8D25:"), result.result);
                }
                _context7.next = 16;
                break;
              case 13:
                _context7.prev = 13;
                _context7.t0 = _context7["catch"](5);
                console.error("\u540C\u6B65\u9884\u7EA6 ".concat(bookingId, " \u8D85\u65F6\u72B6\u6001\u51FA\u9519:"), _context7.t0);
              case 16:
              case "end":
                return _context7.stop();
            }
          }
        }, _callee7, null, [[5, 13]]);
      }))();
    },
    // 格式化倒计时显示 - 根据时间长度调整显示格式
    formatCountdown: function formatCountdown(seconds) {
      if (seconds <= 0) return '已超时';
      var days = Math.floor(seconds / 86400);
      var hours = Math.floor(seconds % 86400 / 3600);
      var minutes = Math.floor(seconds % 3600 / 60);
      var secs = seconds % 60;

      // 根据剩余时间调整显示格式
      if (days > 0) {
        // 超过1天显示"x天y小时"
        return "".concat(days, "\u5929").concat(hours, "\u5C0F\u65F6");
      } else if (hours > 0) {
        // 小于1天但超过1小时显示"x小时y分钟"
        return "".concat(hours, "\u5C0F\u65F6").concat(minutes, "\u5206\u949F");
      } else if (minutes > 0) {
        // 小于1小时但超过1分钟显示"x分y秒"
        return "".concat(minutes, "\u5206").concat(secs, "\u79D2");
      } else {
        // 小于1分钟只显示秒
        return "".concat(secs, "\u79D2");
      }
    },
    // 计算剩余时间（秒）
    calculateRemainingTime: function calculateRemainingTime(booking) {
      try {
        if (!booking || !booking.createTime) {
          return 0;
        }

        // 转换创建时间 - 修复时区问题
        var createTime = new Date(booking.createTime);
        if (isNaN(createTime.getTime())) {
          console.error('无效的创建时间:', booking.createTime);
          return 0;
        }
        var now = new Date();

        // 计算已经过去的时间（毫秒）
        var elapsedMs = now.getTime() - createTime.getTime();
        var elapsedSeconds = Math.floor(elapsedMs / 1000);
        console.log('预约创建时间:', createTime.toLocaleString());
        console.log('当前时间:', now.toLocaleString());
        console.log('已过去秒数:', elapsedSeconds);

        // 支付时限为7天
        var timeLimit = 604800;
        if (elapsedSeconds >= timeLimit) {
          console.log('预约已超过支付时限');

          // 如果超时，立即将预约标记为已取消并设置自动取消标记
          if (booking.status === 'pending') {
            booking.status = 'cancelled';
            booking.autoCancel = true;
            booking.cancelReason = '超时未支付，系统自动取消';

            // 保存到本地存储
            this.storeCancelledBooking(booking);
            console.log('预约已自动取消:', booking.bookingId);
          }
          return 0; // 已超时
        } else {
          var remaining = timeLimit - elapsedSeconds;
          console.log('剩余支付时间(秒):', remaining);
          return remaining; // 剩余秒数
        }
      } catch (e) {
        console.error('计算剩余时间异常:', e);
        return 0;
      }
    },
    // 获取预约的倒计时值
    getPaymentCountdown: function getPaymentCountdown(booking) {
      if (!booking || !booking._id) return 0;
      return this.countdownValues[booking._id] || 0;
    },
    // 清除单个预约的倒计时
    clearCountdown: function clearCountdown(bookingId) {
      if (this.countdownTimers[bookingId]) {
        clearInterval(this.countdownTimers[bookingId]);
        delete this.countdownTimers[bookingId];
      }
    },
    // 清除所有倒计时
    clearAllCountdowns: function clearAllCountdowns() {
      var _this12 = this;
      Object.keys(this.countdownTimers).forEach(function (bookingId) {
        _this12.clearCountdown(bookingId);
      });
      this.countdownTimers = {};
    },
    // 处理支付成功事件
    handlePaymentSuccess: function handlePaymentSuccess(data) {
      console.log('收到支付成功事件:', data);
      if (!data || !data.bookingId) {
        console.error('支付成功事件缺少bookingId');
        return;
      }

      // 查找并更新指定预约的支付状态
      var bookingIndex = this.bookingList.findIndex(function (item) {
        return item && (item._id === data.bookingId || item.bookingId === data.bookingId);
      });
      if (bookingIndex >= 0) {
        // 更新支付状态
        this.bookingList[bookingIndex].paymentStatus = 'paid';

        // 清除该预约的倒计时
        this.clearCountdown(this.bookingList[bookingIndex]._id);

        // 强制更新视图
        this.$forceUpdate();
        console.log("\u6210\u529F\u66F4\u65B0\u9884\u7EA6".concat(data.bookingId, "\u7684\u652F\u4ED8\u72B6\u6001\u4E3A\u5DF2\u652F\u4ED8"));
      } else {
        console.log("\u672A\u627E\u5230\u9884\u7EA6".concat(data.bookingId, "\uFF0C\u5237\u65B0\u5217\u8868\u4EE5\u83B7\u53D6\u6700\u65B0\u6570\u636E"));
        // 刷新列表以获取最新数据
        this.resetList();
        this.loadBookingList();
      }
    },
    // 判断是否应该显示"超时未支付自动取消"标签
    showAutoCancelTag: function showAutoCancelTag(item) {
      if (!item || !item._id || item.status !== 'cancelled') return false;

      // 检查预约对象本身的属性
      if (item.autoCancel === true || item.cancelReason === '超时未支付，系统自动取消') {
        return true;
      }

      // 检查本地存储中是否为自动取消的预约
      var isAutoCancel = this.isAutoCancelBookingFromStorage(item._id);
      if (isAutoCancel) {
        // 更新当前数据，确保属性同步
        item.autoCancel = true;
        item.cancelReason = '超时未支付，系统自动取消';
      }
      return isAutoCancel;
    },
    // 检查预约在本地存储中是否为自动取消
    isAutoCancelBookingFromStorage: function isAutoCancelBookingFromStorage(bookingId) {
      if (!bookingId) return false;
      try {
        var key = "cancelled_booking_".concat(bookingId);
        var bookingStr = uni.getStorageSync(key);
        if (bookingStr) {
          var booking = typeof bookingStr === 'string' ? JSON.parse(bookingStr) : bookingStr;
          return booking.autoCancel === true || booking.cancelReason === '超时未支付，系统自动取消';
        }
      } catch (e) {
        console.error('检查预约自动取消状态失败:', e);
      }
      return false;
    },
    // 在methods中添加格式化日期范围的方法
    formatDateRange: function formatDateRange(item) {
      // 如果没有日期数据，返回"暂无"
      if (!item.startDate && !item.endDate) {
        return '暂无';
      }

      // 格式化单个日期
      var formatDate = function formatDate(dateStr) {
        try {
          if (!dateStr) return '';
          var date = new Date(dateStr);
          if (isNaN(date.getTime())) {
            return dateStr;
          }
          return "".concat(date.getFullYear(), "-").concat((date.getMonth() + 1).toString().padStart(2, '0'), "-").concat(date.getDate().toString().padStart(2, '0'));
        } catch (e) {
          return dateStr;
        }
      };

      // 如果有开始和结束日期，显示范围
      if (item.startDate && item.endDate) {
        return "".concat(formatDate(item.startDate), "-").concat(formatDate(item.endDate));
      } else if (item.startDate) {
        return formatDate(item.startDate);
      } else if (item.endDate) {
        return formatDate(item.endDate);
      }

      // 尝试使用courseStartDate和courseEndDate作为备选
      if (item.courseStartDate && item.courseEndDate) {
        return "".concat(formatDate(item.courseStartDate), "-").concat(formatDate(item.courseEndDate));
      } else if (item.courseStartDate) {
        return formatDate(item.courseStartDate);
      } else if (item.courseEndDate) {
        return formatDate(item.courseEndDate);
      }
      return '暂无';
    }
  }
};
exports.default = _default;
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 2)["default"], __webpack_require__(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js */ 26)["uniCloud"]))

/***/ }),

/***/ 238:
/*!************************************************************************************************************************************!*\
  !*** C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/pages/user/booking.vue?vue&type=style&index=0&lang=scss& ***!
  \************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./booking.vue?vue&type=style&index=0&lang=scss& */ 239);
/* harmony import */ var _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_HBuilderX_4_55_2025030718_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_booking_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 239:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/liuxingyu/Desktop/TurboTrainning-main/yueke/Siwei_chuzhong/pages/user/booking.vue?vue&type=style&index=0&lang=scss& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[232,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/user/booking.js.map