<view class="detail-container"><view class="{{['status-bar','status-'+bookingDetail.status]}}"><view class="status-icon"><text class="{{['iconfont',statusIcon]}}"></text></view><view class="status-info"><view class="status-text">{{statusText}}</view><block wx:if="{{bookingDetail.status==='pending'&&bookingDetail.paymentStatus!=='paid'&&bookingDetail.paymentStatus!=='refunded'}}"><view class="status-countdown" style="margin-top:10rpx;"><block wx:if="{{paymentCountdown>0}}"><text><text class="countdown-label">支付倒计时：</text><text class="countdown-time">{{$root.m0}}</text></text></block><block wx:else><text class="countdown-time">正在加载支付时限...</text></block></view></block><view class="status-desc">{{statusDesc}}</view><block wx:if="{{bookingDetail.isCourseDeleted}}"><view class="status-desc course-deleted">{{''+(bookingDetail.courseDeletedNote||'课程已删除')+''}}</view></block><block wx:if="{{bookingDetail.status==='cancelled'&&bookingDetail.autoCancel}}"><view class="status-desc auto-cancel">{{''+(bookingDetail.cancelReason||'超时未支付，系统自动取消')+''}}</view></block></view></view><view class="info-card"><view class="card-title">课程信息</view><view class="course-title">{{bookingDetail.courseTitle}}</view><block wx:if="{{bookingDetail.isCourseDeleted}}"><view class="course-deleted-tag">课程已删除</view></block><view class="info-row"><text class="info-label">课程时间：</text><text class="info-value">{{formattedCourseTime}}</text></view><view class="info-row"><text class="info-label">课程日期：</text><text class="info-value">{{bookingDetail.startDate+" 至 "+bookingDetail.endDate}}</text></view><view class="info-row"><text class="info-label">校区地点：</text><text class="info-value">{{bookingDetail.schoolName}}</text></view><view class="info-row teacher-info"><text class="info-label">任课教师：</text><text class="info-value teacher-name">{{bookingDetail.teacherName||'暂无指定教师'}}</text><block wx:if="{{bookingDetail.teacherPhone}}"><text data-event-opts="{{[['tap',[['callTeacher',['$event']]]]]}}" class="phone-link" bindtap="__e">{{''+bookingDetail.teacherPhone+''}}<text class="iconfont icon-phone"></text></text></block></view><view class="info-row"><text class="info-label">预约时间：</text><text class="info-value">{{$root.m1}}</text></view></view><view class="info-card"><view class="card-title">学生信息</view><view class="info-row"><text class="info-label">学生姓名：</text><text class="info-value">{{bookingDetail.studentName}}</text></view><view class="info-row"><text class="info-label">联系电话：</text><text class="info-value">{{bookingDetail.userPhoneNumber||'暂无'}}</text></view><block wx:if="{{bookingDetail.remark}}"><view class="info-row"><text class="info-label">备注信息：</text><text class="info-value">{{bookingDetail.remark}}</text></view></block></view><view class="bottom-space"></view><view class="action-area"><view class="action-bar"><block wx:if="{{bookingDetail.status==='pending'||bookingDetail.status==='confirmed_unpaid'||bookingDetail.status==='confirmed'&&bookingDetail.paymentStatus!=='paid'}}"><block><view data-event-opts="{{[['tap',[['cancelBooking',['$event']]]]]}}" class="action-btn primary" bindtap="__e">取消预约</view></block></block><block wx:if="{{(bookingDetail.status==='pending'||bookingDetail.status==='confirmed_unpaid'||bookingDetail.status==='confirmed'&&bookingDetail.paymentStatus!=='paid')&&bookingDetail.paymentStatus!=='refunded'}}"><view data-event-opts="{{[['tap',[['goToPay',['$event']]]]]}}" class="action-btn pay-btn" bindtap="__e">去缴费</view></block><block wx:if="{{isNeedContactTeacher}}"><block><view data-event-opts="{{[['tap',[['contactTeacher',['$event']]]]]}}" class="action-btn primary" bindtap="__e">联系老师</view></block></block><block wx:if="{{bookingDetail.paymentStatus==='paid'}}"><view data-event-opts="{{[['tap',[['handleRefund',['$event']]]]]}}" class="action-btn refund-btn" bindtap="__e">申请退费</view></block><view data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="action-btn outline" bindtap="__e">返回列表</view></view></view><uni-popup class="vue-ref" vue-id="09fed566-1" type="dialog" data-ref="cancelPopup" bind:__l="__l" vue-slots="{{['default']}}"><uni-popup-dialog vue-id="{{('09fed566-2')+','+('09fed566-1')}}" title="取消预约" content="确定要取消此预约吗？取消后无法恢复" before-close="{{true}}" data-event-opts="{{[['^confirm',[['confirmCancel']]],['^close',[['closePopup']]]]}}" bind:confirm="__e" bind:close="__e" bind:__l="__l"></uni-popup-dialog></uni-popup></view>