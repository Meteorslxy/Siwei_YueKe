<view class="booking-admin"><view class="header"><text class="title">预约管理</text><view class="actions"><button data-event-opts="{{[['tap',[['refreshData',['$event']]]]]}}" class="btn-default" bindtap="__e">刷新</button></view></view><view class="filter-bar"><view data-event-opts="{{[['tap',[['filterByStatus',['all']]]]]}}" class="{{['filter-item',(status==='all')?'active':'']}}" bindtap="__e">全部</view><view data-event-opts="{{[['tap',[['filterByStatus',['pending']]]]]}}" class="{{['filter-item',(status==='pending')?'active':'']}}" bindtap="__e">待确认</view><view data-event-opts="{{[['tap',[['filterByStatus',['confirmed']]]]]}}" class="{{['filter-item',(status==='confirmed')?'active':'']}}" bindtap="__e">已确认</view><view data-event-opts="{{[['tap',[['filterByStatus',['completed']]]]]}}" class="{{['filter-item',(status==='completed')?'active':'']}}" bindtap="__e">已完成</view><view data-event-opts="{{[['tap',[['filterByStatus',['cancelled']]]]]}}" class="{{['filter-item',(status==='cancelled')?'active':'']}}" bindtap="__e">已取消</view></view><block wx:if="{{$root.g0>0}}"><view class="content"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="_id"><view class="booking-item"><view class="booking-info"><view class="info-section"><view class="booking-id">{{"#"+item.m0}}</view><view class="{{['status-tag',(item.$orig.status==='pending')?'status-pending':'',(item.$orig.status==='confirmed')?'status-confirmed':'',(item.$orig.status==='completed')?'status-completed':'',(item.$orig.status==='cancelled')?'status-cancelled':'']}}">{{item.m1}}</view></view><view class="course-section"><view class="course-title">{{item.$orig.courseName||'未知课程'}}</view><view class="time">{{"预约时间："+item.m2}}</view><view class="time">{{"上课时间："+item.m3}}</view></view><view class="user-section"><view class="label">预约人信息</view><view class="user-name">{{"姓名："+item.$orig.userName}}</view><view class="user-phone">{{"电话："+item.$orig.userPhone}}</view></view><block wx:if="{{item.$orig.remark}}"><view class="remark-section"><view class="label">备注</view><view class="remark">{{item.$orig.remark}}</view></view></block></view><view class="actions"><block wx:if="{{item.$orig.status==='pending'}}"><text data-event-opts="{{[['tap',[['confirmBooking',['$0'],[[['filteredBookingList','_id',item.$orig._id]]]]]]]}}" class="action confirm" bindtap="__e">确认</text></block><block wx:if="{{item.$orig.status==='pending'||item.$orig.status==='confirmed'}}"><text data-event-opts="{{[['tap',[['cancelBooking',['$0'],[[['filteredBookingList','_id',item.$orig._id]]]]]]]}}" class="action cancel" bindtap="__e">取消</text></block><block wx:if="{{item.$orig.status==='confirmed'}}"><text data-event-opts="{{[['tap',[['completeBooking',['$0'],[[['filteredBookingList','_id',item.$orig._id]]]]]]]}}" class="action complete" bindtap="__e">完成</text></block><text data-event-opts="{{[['tap',[['viewBookingDetail',['$0'],[[['filteredBookingList','_id',item.$orig._id]]]]]]]}}" class="action view" bindtap="__e">详情</text></view></view></block></view></block><block wx:else><block wx:if="{{!loading}}"><view class="empty"><text class="empty-text">暂无预约数据</text></view></block></block><block wx:if="{{loading}}"><view class="loading"><view class="spinner"></view></view></block></view>