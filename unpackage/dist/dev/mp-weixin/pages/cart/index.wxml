<view class="favorite-page"><view class="filter-bar"><view class="page-title">购物车</view><view data-event-opts="{{[['tap',[['toggleManageMode',['$event']]]]]}}" class="manage-btn" bindtap="__e">{{isManageMode?'完成':'管理'}}</view></view><view class="favorite-list"><block wx:if="{{$root.g0>0}}"><block><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="{{['favorite-item',(item.$orig.inactive)?'inactive':'']}}"><block wx:if="{{!item.$orig.inactive}}"><view data-event-opts="{{[['tap',[['toggleSelect',[index]]]]]}}" class="checkbox-wrapper" catchtap="__e"><checkbox checked="{{item.$orig.selected}}" color="#FF6B00"></checkbox></view></block><block wx:else><view class="checkbox-wrapper"><view class="inactive-icon">失效</view></view></block><view data-event-opts="{{[['tap',[['handleClick',[index]]]]]}}" class="item-content" bindtap="__e"><view class="item-image"><image src="{{item.m0}}" mode="aspectFill" data-event-opts="{{[['error',[['handleImageError',[index]]]]]}}" binderror="__e"></image></view><view class="item-info"><view class="item-title">{{item.$orig.itemTitle||'未命名'}}</view><view class="item-type">{{item.m1}}</view><block wx:if="{{!item.$orig.inactive}}"><view class="item-price">{{"¥"+(item.$orig.price||0)+".00"}}</view></block><block wx:if="{{item.$orig.inactive}}"><view class="item-notice">{{item.$orig.noticeText||'该课程已下架或不存在'}}</view></block><view class="item-time">{{item.m2}}</view></view></view><view class="item-action"><block wx:if="{{!isManageMode&&!item.$orig.inactive}}"><button data-event-opts="{{[['tap',[['bookCourse',['$0'],[[['favoriteList','',index]]]]]]]}}" class="action-btn book-btn" catchtap="__e">立即预约</button></block><block wx:else><view data-event-opts="{{[['tap',[['handleDelete',[index]]]]]}}" class="action-btn delete-btn" bindtap="__e"><text class="iconfont icon-delete"></text><text class="delete-text">删除</text></view></block></view></view></block></block></block><block wx:else><empty-tip vue-id="6a21c8ac-1" tip="购物车空空如也" show="{{!loading}}" bind:__l="__l"></empty-tip></block><load-more vue-id="6a21c8ac-2" status="{{loadMoreStatus}}" data-event-opts="{{[['^click',[['loadMore']]]]}}" bind:click="__e" bind:__l="__l"></load-more></view><block wx:if="{{$root.g1>0}}"><view class="cart-footer"><view data-event-opts="{{[['tap',[['toggleSelectAll',['$event']]]]]}}" class="select-all" bindtap="__e"><checkbox checked="{{isAllSelected}}" color="#FF6B00"></checkbox><text>全选</text></view><view class="total-price"><text>合计：</text><text class="price-value">{{"¥"+totalPrice+".00"}}</text></view><button class="checkout-btn" disabled="{{selectedCount===0}}" data-event-opts="{{[['tap',[['checkout',['$event']]]]]}}" bindtap="__e">{{''+(isManageMode?'删除':'一键预约')+"("+selectedCount+')'}}</button></view></block></view>